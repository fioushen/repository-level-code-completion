{"filename": "src/types.ts", "chunked_list": ["export enum Endpoints {\n\t\tToken = '/connect/token',\n\t\tNonce = '/nonce',\n\t\tPublikusIntezmenyek = '/intezmenyek/kreta/publikus',\n\t\tFeljegyzesek = '/Sajat/Feljegyzesek',\n\t\tFaliujsagElemek = '/Sajat/FaliujsagElemek',\n\t\tTanulo = '/Sajat/TanuloAdatlap',\n\t\tErtekelesek = '/Sajat/Ertekelesek',\n\t\tTantargyiAtlagok = '/Sajat/Ertekelesek/Atlagok/TantargyiAtlagok',\n\t\tMulasztasok = '/Sajat/Mulasztasok',\n", "\tOsztalyCsoportok = '/Sajat/OsztalyCsoportok',\n\t\tOsztalyCsoportAtlag = '/Sajat/Ertekelesek/Atlagok/OsztalyAtlagok',\n\t\tOrarendElemek = '/Sajat/OrarendElemek',\n\t\tOrarendElem = '/Sajat/OrarendElem',\n\t\tSzamonkeresek = '/Sajat/BejelentettSzamonkeresek',\n\t\tHaziFeladatok = '/Sajat/HaziFeladatok',\n\t\tIntezmenyek = '/Sajat/Intezmenyek',\n\t\tOsztalyfonokok = '/Felhasznalok/Alkalmazottak/Tanarok/Osztalyfonokok',\n\t\tOrarendHetek = '/Sajat/Intezmenyek/Hetirendek/Orarendi',\n\t\tTanevNaptar = '/Sajat/Intezmenyek/TanevRendjeElemek',\n", "\tEloadasok = '/Lep/Eloadasok',\n\t\tEszkozAllapot = '/TargyiEszkoz/IsEszkozKiosztva'\n\t}\n\texport enum AdministrationEndpoints {\n\t\tCimzettTipusok = '/adatszotarak/cimzetttipusok',\n\t\tKerelemTipusok = '/adatszotarak/kerelemtipusok',\n\t\tTmgiIgazolasTipusok = '/adatszotarak/tmgiigazolastipusok',\n\t\tEsemenyek = '/belepteto/kartyaesemenyek/sajat',\n\t\tJelenlegiIntezmenyModulok = '/intezmenyek/sajat/modulok',\n\t\tCimezhetoTipusok = '/kommunikacio/cimezhetotipusok',\n", "\tCimezhetoOsztalyok = '/kommunikacio/osztalyok/cimezheto',\n\t\tOlvasatlanokSzama = '/kommunikacio/postaladaelemek/olvasatlanokszama',\n\t\tUzenetek = '/kommunikacio/postaladaelemek/sajat',\n\t\tUzenet = '/kommunikacio/postaladaelemek',\n\t\tCimezhetoSzmkKepviselok = '/kommunikacio/szmkkepviselok/cimezheto',\n\t\tUzenetLimitacio = '/kommunikacio/uzenetek/kuldhetok/korlat',\n\t\tAdminisztratorok = '/kreta/alkalmazottak/adminisztrator',\n\t\tIgazgatok = '/kreta/alkalmazottak/igazgatosag',\n\t\tOsztalyfonokok = '/kreta/alkalmazottak/oszalyfonok',\n\t\tOktatok = '/kreta/alkalmazottak/tanar',\n", "\tCimezhetoTanuloSzulok = '/kreta/gondviselok/osztaly',\n\t\tJelenlegiIntezmeny = '/ugy/aktualisIntezmenyAdatok'\n\t}\n\texport enum API {\n\t\tINSTITUTE = 'https://{{institute_code}}.e-kreta.hu',\n\t\tIDP = 'https://idp.e-kreta.hu',\n\t\tADMINISTRATION = 'https://eugyintezes.e-kreta.hu',\n\t\tGLOBAL = 'https://kretaglobalapi.e-kreta.hu'\n\t}\n\texport interface RequestDateRangeOptions {\n", "\tdateFrom?: string;\n\t\tdateTo?: string;\n\t}\n\texport interface RequestDateRangeRequiredOptions {\n\t\tdateFrom: string;\n\t\tdateTo: string;\n\t}\n\texport interface RequestClassAveragesOptions {\n\t\toktatasiNevelesiFeladatUid?: string;\n\t\tsubjectUid?: string;\n", "}\n\texport interface RequestHomeWorkOptions extends RequestDateRangeOptions {\n\t\tdateFrom: string;\n\t}\n\texport interface RequestAnnouncedTestsOptions extends RequestDateRangeOptions {\n\t\tuids?: string[] | number[];\n\t}\n\texport interface ConfigurationDescriptor {\n\t\tGlobalMobileApiUrlDEV: string;\n\t\tGlobalMobileApiUrlPROD: string;\n", "\tGlobalMobileApiUrlTEST: string;\n\t\tGlobalMobileApiUrlUAT: string;\n\t}\n\texport interface NonceHashOptions {\n\t\tinstitute_code: string;\n\t\tnonce: string;\n\t\tusername: string;\n\t}\n\texport interface AuthenticationFields {\n\t\tinstitute_code: string;\n", "\tpassword: string;\n\t\tusername: string;\n\t}\n\texport interface RequestRefreshTokenOptions {\n\t\trefreshUserData: boolean;\n\t\trefreshToken: string;\n\t}\n\texport interface AccessToken {\n\t\taccess_token: string | null;\n\t\trefresh_token: string | null;\n", "\ttoken_type: string | null;\n\t}\n\texport interface KretaOptions extends AuthenticationFields {\n\t}\n\texport interface AuthenticationResponse {\n\t\taccess_token: string;\n\t\texpires_in: number;\n\t\tid_token: string | null;\n\t\trefresh_token: string;\n\t\tscope: string;\n", "\ttoken_type: string;\n\t}\n\texport interface PreBuiltAuthenticationToken {\n\t\ttoken: string;\n\t\taccess_token: string;\n\t\trefresh_token: string;\n\t}\n\tinterface ResponseErrorItem {\n\t\tPropertyName: string;\n\t\tMessage: string;\n", "\tExceptionType: string;\n\t}\n\texport interface ResponseError {\n\t\tExceptionId: string;\n\t\tExceptionType: string;\n\t\tMessage: string;\n\t\tErrorList: ResponseErrorItem[] | null;\n\t\terror?: string;\n\t}\n\texport type RequestResponseError = ResponseError | string | undefined;\n", "interface SystemModule {\n\t\tIsAktiv: boolean;\n\t\tTipus: string;\n\t\tUrl: string | null;\n\t}\n\tinterface CustomizationSettings {\n\t\tErtekelesekMegjelenitesenekKesleltetesenekMerteke: number;\n\t\tIsDiakRogzithetHaziFeladatot: boolean;\n\t\tIsOsztalyAtlagMegjeleniteseEllenorzoben: boolean;\n\t\tIsTanorakTemajaMegtekinthetoEllenorzoben: boolean;\n", "\tKovetkezoTelepitesDatuma: string;\n\t}\n\texport interface Institution {\n\t\tRendszermodulok: SystemModule[];\n\t\tRovidNev: string | null;\n\t\tTestreszabasBeallitasok: CustomizationSettings;\n\t\tUid: string;\n\t}\n\tinterface ValueDescriptor {\n\t\tLeiras: string;\n", "\tNev: string;\n\t\tUid: string;\n\t}\n\tinterface UidStructure {\n\t\tUid: string;\n\t}\n\tinterface BankAccount {\n\t\tBankszamlaSzam: string | null;\n\t\tBankszamlaTulajdonosNeve: string | null;\n\t\tBankszamlaTulajdonosTipusId: number | null;\n", "\tIsReadOnly: boolean | null;\n\t}\n\tinterface Guardian {\n\t\tEmailCim: string | null;\n\t\tIdpUniqueId: string;\n\t\tIsTorvenyesKepviselo: boolean | null;\n\t\tNev: string;\n\t\tTelefonszam: string | null;\n\t\tUid: string;\n\t}\n", "export interface Student {\n\t\tAnyjaNeve: string;\n\t\tBankszamla: BankAccount;\n\t\tCimek: string[];\n\t\tEmailCim: string | null;\n\t\tGondviselok: Guardian[];\n\t\tIdpUniqueId: string;\n\t\tIntezmeny: Institution;\n\t\tIntezmenyAzonosito: string;\n\t\tIntezmenyNev: string;\n", "\tIsEszkozKiosztva: boolean;\n\t\tNev: string;\n\t\tSzuletesiDatum: string;\n\t\tSzuletesiEv: number;\n\t\tSzuletesiHely: string;\n\t\tSzuletesiHonap: number;\n\t\tSzuletesiNap: number;\n\t\tSzuletesiNev: string;\n\t\tTanevUid: number;\n\t\tTelefonszam: string | null;\n", "\tUid: string;\n\t}\n\tinterface SubjectDescriptor {\n\t\tKategoria: ValueDescriptor;\n\t\tNev: string;\n\t\tUid: string;\n\t\tSortIndex: number;\n\t}\n\texport interface Institute {\n\t\tadvertisingUrl: string;\n", "\tcity: string;\n\t\tfeatureToggleSet: {};\n\t\tinformationImageUrl: string;\n\t\tinformationUrl: string;\n\t\tinstituteCode: string;\n\t\tinstituteId: number;\n\t\tname: string;\n\t\turl: string;\n\t}\n\texport interface InstituteGlobal {\n", "\taktivTanevGuid: string;\n\t\taktivTanevId: number;\n\t\taktivTanevNev: string;\n\t\tazonosito: string;\n\t\tfenntartoAzonosito: string;\n\t\tfenntartoNev: string;\n\t\tid: string;\n\t\tkornyezetId: number;\n\t\tkornyezetNev: string;\n\t\tkornyezetTeljesNev: string;\n", "\tkretaLink: string;\n\t\tnev: string;\n\t\tomKod: string;\n\t\trovidNev: string;\n\t\ttelepules: string;\n\t}\n\texport interface Evaluation {\n\t\tErtekFajta: ValueDescriptor;\n\t\tErtekeloTanarNeve: string;\n\t\tJelleg: string | null;\n", "\tKeszitesDatuma: string;\n\t\tLattamozasDatuma: string | null;\n\t\tMod: ValueDescriptor | null;\n\t\tOsztalyCsoport: UidStructure;\n\t\tRogzitesDatuma: string;\n\t\tSortIndex: number;\n\t\tSulySzazalekErteke: number | null;\n\t\tSzamErtek: number | null;\n\t\tSzovegesErtek: string;\n\t\tSzovegesErtekelesRovidNev: string | null;\n", "\tTantargy: SubjectDescriptor | null;\n\t\tTema: string | null;\n\t\tTipus: ValueDescriptor;\n\t\tUid: string;\n\t}\n\texport interface Note {\n\t\tCim: string;\n\t\tDatum: string;\n\t\tKeszitesDatuma: string;\n\t\tKeszitoTanarNeve: string;\n", "\tLattamozasDatuma: string | null;\n\t\tOsztalyCsoport: UidStructure | null;\n\t\tTartalom: string;\n\t\tTipus: ValueDescriptor;\n\t\tUid: string;\n\t}\n\texport interface AnnouncedTest {\n\t\tBejelentesDatuma: string;\n\t\tDatum: string;\n\t\tModja: ValueDescriptor;\n", "\tOrarendiOraOraszama: number;\n\t\tOsztalyCsoport: UidStructure;\n\t\tRogzitoTanarNeve: string;\n\t\tTantargy: SubjectDescriptor | null;\n\t\tTantargyNeve: string | null;\n\t\tTemaja: string | null;\n\t\tUid: string;\n\t}\n\tinterface Attachment {\n\t\tNev: string;\n", "\tTipus: string;\n\t\tUid: string;\n\t}\n\texport interface Homework {\n\t\tCsatolmanyok: Attachment[] | null;\n\t\tFeladasDatuma: string;\n\t\tHataridoDatuma: string;\n\t\tIsBeadhato: boolean;\n\t\tIsCsatolasEngedelyezes: boolean;\n\t\tIsMegoldva: boolean;\n", "\tIsTanarRogzitette: boolean;\n\t\tIsTanuloHaziFeladatEnabled: boolean;\n\t\tOsztalyCsoport: UidStructure | null;\n\t\tRogzitesIdopontja: string;\n\t\tRogzitoTanarNeve: string;\n\t\tSzoveg: string | null;\n\t\tTantargy: SubjectDescriptor | null;\n\t\tTantargyNeve: string | null;\n\t\tUid: string;\n\t}\n", "interface OmissionLesson {\n\t\tKezdoDatum: string;\n\t\tOraszam: number;\n\t\tVegDatum: string;\n\t}\n\ttype JustificationState = 'None' | 'Igazolatlan' | 'Igazolt' | 'Igazolando'\n\texport interface Omission {\n\t\tDatum: string;\n\t\tIgazolasAllapota: JustificationState;\n\t\tIgazolasTipusa: ValueDescriptor | null;\n", "\tKesesPercben: number | null;\n\t\tKeszitesDatuma: string;\n\t\tMod: ValueDescriptor;\n\t\tOra: OmissionLesson;\n\t\tOsztalyCsoport: UidStructure;\n\t\tRogzitoTanarNeve: string;\n\t\tTantargy: SubjectDescriptor;\n\t\tTipus: ValueDescriptor;\n\t\tUid: string;\n\t}\n", "interface GroupMembership {\n\t\tBesorolasDatuma: string | null;\n\t\tKisorolasDatuma: string | null;\n\t}\n\texport interface Group {\n\t\tIsAktiv: boolean;\n\t\tNev: string;\n\t\tOktatasNevelesiFeladat: ValueDescriptor;\n\t\tOktatasNevelesiFeladatSortIndex: number;\n\t\tOktatasNevelesiKategoria: ValueDescriptor;\n", "\tOsztalyFonok: UidStructure | null;\n\t\tOsztalyFonokHelyettes: UidStructure | null;\n\t\tTagsagok: GroupMembership[];\n\t\tTipus: string;\n\t\tUid: string;\n\t}\n\tinterface AverageWithTime {\n\t\tAtlag: number;\n\t\tDatum: string;\n\t}\n", "export interface SubjectAverage {\n\t\tAtlag: number | null;\n\t\tAtlagAlakulasaIdoFuggvenyeben: AverageWithTime[];\n\t\tSortIndex: number;\n\t\tSulyozottOsztalyzatOsszege: number | null;\n\t\tSulyozottOsztalyzatSzama: number | null;\n\t\tTantargy: SubjectDescriptor;\n\t\tUid: string;\n\t}\n\tinterface LessonAttachment {\n", "\tNev: string;\n\t\tUid: string;\n\t}\n\tinterface UidNameStructure {\n\t\tNev: string;\n\t\tUid: string;\n\t}\n\texport interface Lesson {\n\t\tAllapot: ValueDescriptor;\n\t\tBejelentettSzamonkeresUid: string | null;\n", "\tCsatolmanyok: LessonAttachment[] | null;\n\t\tDatum: string;\n\t\tDigitalisEszkozTipus: string | null;\n\t\tDigitalisPlatformTipus: string | null;\n\t\tDigitalisTamogatoEszkozTipusList: string[] | null;\n\t\tFeladatGroupUid: string | null;\n\t\tHaziFeladatUid: string | null;\n\t\tHelyettesTanarNeve: string | null;\n\t\tIsDigitalisOra: boolean;\n\t\tIsHaziFeladatMegoldva: boolean;\n", "\tIsTanuloHaziFeladatEnabled: boolean;\n\t\tKezdetIdopont: string;\n\t\tLetrehozas: string;\n\t\tNev: string | null;\n\t\tNyelviFeladatGroupUid: string | null;\n\t\tOraEvesSorszama: number | null;\n\t\tOraszam: number;\n\t\tOsztalyCsoport: UidNameStructure;\n\t\tTanarNeve: string | null;\n\t\tTantargy: SubjectDescriptor;\n", "\tTanuloJelenlet: ValueDescriptor | null;\n\t\tTema: string | null;\n\t\tTeremNeve: string | null;\n\t\tTipus: ValueDescriptor;\n\t\tUid: string;\n\t\tUtolsoModositas: string | null;\n\t\tVegIdopont: string;\n\t}\n\texport interface NoticeBoardItem {\n\t\tCim: string;\n", "\tErvenyessegKezdete: string;\n\t\tErvenyessegVege: string;\n\t\tRogzitoNeve: string;\n\t\tTartalom: string;\n\t\tUid: string;\n\t}\n\texport interface ClassAverage {\n\t\tOsztalyCsoportAtlag: number | null;\n\t\tOsztalyCsoportAtlagtolValoElteres: number | null;\n\t\tTantargy: SubjectDescriptor;\n", "\tTanuloAtlag: number | null;\n\t\tUid: string;\n\t}\n\tinterface Employee {\n\t\tEmailek: string[] | null;\n\t\tNev: string;\n\t\tTelefonok: string[] | null;\n\t\tUid: string;\n\t}\n\tinterface Teacher {\n", "\tAlkalmazott: Employee;\n\t\tUid: string;\n\t}\n\tinterface Class {\n\t\tNev: string;\n\t\tOktatasiNevelesiKategoria: ValueDescriptor;\n\t\tUid: string;\n\t}\n\texport interface ClassMaster {\n\t\tOsztalyai: Class[];\n", "\tTanar: Teacher;\n\t\tUid: string;\n\t}\n\texport interface TimeTableWeek {\n\t\tHetSorszama: number;\n\t\tKezdoNapDatuma: string;\n\t\tTipus: ValueDescriptor | null;\n\t\tUid: string;\n\t\tVegNapDatuma: string;\n\t}\n", "export interface LepEvent {\n\t\tDatum: string;\n\t\tEloadasKezdete: string;\n\t\tEloadasNev: string;\n\t\tEloadasVege: string;\n\t\tGondviseloElfogadas: boolean | null;\n\t\tHelyszin: string;\n\t\tMegjelent: boolean;\n\t\tSzervezetNev: string;\n\t\tUid: string;\n", "}\n\texport interface SchoolYearCalendarEntry {\n\t\tDatum: string;\n\t\tElteroOrarendSzerintiTanitasiNap: ValueDescriptor | null;\n\t\tNaptipus: ValueDescriptor;\n\t\tOrarendiNapHetirendje: ValueDescriptor;\n\t\tOsztalyCsoport: UidStructure | null;\n\t\tUid: string;\n\t}\n\texport interface AddresseType {\n", "\tazonosito: number | null;\n\t\tkod: string | null;\n\t\tleiras: string | null;\n\t\tnev: string | null;\n\t\trovidNev: string | null;\n\t}\n\texport interface DefaultType {\n\t\tazonosito: number;\n\t\tkod: string;\n\t\tleiras: string;\n", "\tnev: string;\n\t\trovidNev: string;\n\t}\n\texport interface CardEvent {\n\t\tazonosito: number;\n\t\tidopont: string;\n\t\tirany: string | null;\n\t\tmegjegyzes: string | null;\n\t}\n\texport interface KretaClass {\n", "\tkretaAzonosito: number;\n\t\tnev: string | null;\n\t}\n\tinterface Addresse {\n\t\tazonosito: number;\n\t\tkretaAzonosito: number;\n\t\tnev: string;\n\t\ttipus: DefaultType;\n\t}\n\tinterface TemporaryId {\n", "\tazonosito: number | null;\n\t\tfileHandler: string | null;\n\t\tideiglenesFajlAzonosito: string | null;\n\t\tutvonal: string | null;\n\t}\n\tinterface AdministrationAttachment {\n\t\tazonosito: number;\n\t\tfajl: TemporaryId | null;\n\t\tfajlNeve: string;\n\t}\n", "interface Message {\n\t\tazonosito: number | null;\n\t\tcimzettLista: Addresse[] | null;\n\t\tcsatolmanyok: AdministrationAttachment[] | null;\n\t\telozoUzenetAzonosito: number | null;\n\t\tfeladoNev: string | null;\n\t\tfeladoTitulus: string | null;\n\t\tkuldesDatum: string | null;\n\t\tszoveg: string | null;\n\t\ttargy: string | null;\n", "}\n\texport interface MailboxItem {\n\t\tazonosito: number;\n\t\tisElolvasva: boolean;\n\t\tisToroltElem: boolean;\n\t\ttipus: DefaultType;\n\t\tuzenet: Message;\n\t}\n\texport interface GuardianEAdmin {\n\t\tSZMKOsztaly: string | null;\n", "\temailCim: string | null;\n\t\tgondviseloNev: string | null;\n\t\tisSZMK: boolean | null;\n\t\tisSZMKHelyettes: boolean | null;\n\t\tisTorvenyesKepviselo: boolean | null;\n\t\tkretaAzonosito: number | null;\n\t\trokonsagiFok: string | null;\n\t\tsZMKOsztalyHelyettes: string | null;\n\t\tsZMKOsztalyHelyettesKretaAzonosito: number | null;\n\t\tsZMKOsztalyKretaAlkalmazott: number | null;\n", "\tsZMKOsztalyKretaAzonosito: number | null;\n\t\ttanuloNev: string | null;\n\t\ttanuloOktatasiAzonosito: string | null;\n\t\ttanuloOsztaly: string | null;\n\t\ttanuloOsztalyKretaAzonosito: number | null;\n\t}\n\texport interface MessageLimitations {\n\t\tisCsakEgyCimzettLehet: boolean;\n\t\tisKuldhetoUzenetekSzamaKorlatozvaVan: boolean;\n\t\tkuldhetoUzenetekSzamaMegMa: number;\n", "}\n\texport interface EmployeeDetails {\n\t\tisAdmin: boolean | null;\n\t\tisAlairo: boolean | null;\n\t\tisIgazgato: boolean | null;\n\t\tisIgazgatoHelyettes: boolean | null;\n\t\tisOsztalyfonok: boolean | null;\n\t\tisOsztalyfonokHelyettes: boolean | null;\n\t\tisTanar: boolean | null;\n\t\tisTorolt: boolean | null;\n", "\tkretaAzonosito: number | null;\n\t\tnev: string | null;\n\t\toktatasiAzonosito: string | null;\n\t\tosztaly: string | null;\n\t\tosztalyHelyettes: string | null;\n\t\tosztalyHelyettesKretaAzonosito: number | null;\n\t\tosztalyKretaAzonosito: number | null;\n\t\ttitulus: string | null;\n\t}\n\texport interface CurrentInstitutionDetails {\n", "\tazonosito: number | null;\n\t\tkretaIntezmenyAzonosito: string | null;\n\t\tomAzonosito: string | null;\n\t\tnev: string | null;\n\t\ttankeruletNeve: string | null;\n\t\tintezmenyCim: string | null;\n\t\tpenztarjelentesAzonositoElotag: string | null;\n\t\tisAltalanos: false;\n\t\tisKozepfoku: true;\n\t\tisSzeusz: false;\n", "\tertesitesiEmailCim: string | null;\n\t\tIsUzenetKezelesElerheto: true;\n\t\tIsRFIDIntezmeny: false;\n\t\ttagozatLista: string[];\n\t\tetkezesMegrendelesTipus: DefaultType | null;\n\t}\n"]}
{"filename": "src/index.ts", "chunked_list": ["import Kreta from './lib/Kreta';\n\timport { Authentication as KretaAuthentication } from './lib/Authentication';\n\texport * from './types';\n\texport { Kreta, KretaAuthentication };\n"]}
{"filename": "src/utils/dynamicValue.ts", "chunked_list": ["export default function dynamicValue(str: string, values: { [key: string]: any }): string {\n\t\treturn str.replace(/{{(.*?)}}/g, (match: string, key) => values[key] || match);\n\t}\n"]}
{"filename": "src/utils/validateDate.ts", "chunked_list": ["import moment from 'moment';\n\timport KretaError from '../lib/errors/KretaError';\n\texport default function validateDate(date: string): string {\n\t\tif (!moment(date, 'YYYY-MM-DD', true).isValid())\n\t\t\tthrow new KretaError('Invalid date provided');\n\t\telse\n\t\t\treturn date;\n\t}\n"]}
{"filename": "src/utils/tryRequest.ts", "chunked_list": ["import { AxiosError } from 'axios';\n\timport KretaError from '../lib/errors/KretaError';\n\timport { RequestResponseError } from '../types';\n\texport default async function tryRequest(axios: Promise<void>): Promise<void> {\n\t\ttry {\n\t\t\treturn await axios;\n\t\t} catch (error) {\n\t\t\tconst e: AxiosError<RequestResponseError> = error as AxiosError<RequestResponseError>;\n\t\t\tif (e.response?.status) {\n\t\t\t\tlet errorMsg: string = '';\n", "\t\t\tconst rd: RequestResponseError = e.response?.data!;\n\t\t\t\tif (typeof rd === 'string')\n\t\t\t\t\terrorMsg = rd;\n\t\t\t\telse if (rd.ErrorList && rd.ErrorList.length > 0) {\n\t\t\t\t\tif (rd.ErrorList[1]?.Message)\n\t\t\t\t\t\terrorMsg = rd.ErrorList[1].Message;\n\t\t\t\t\telse if (rd.ErrorList[0]?.Message)\n\t\t\t\t\t\terrorMsg = rd.ErrorList[0].Message;\n\t\t\t\t} else if (rd.Message)\n\t\t\t\t\terrorMsg = rd.Message;\n", "\t\t\telse if (rd.error)\n\t\t\t\t\terrorMsg = rd.error;\n\t\t\t\telse\n\t\t\t\t\terrorMsg = 'Unknown error';\n\t\t\t\tthrow new KretaError(`Request failed with status code ${e.response?.status}: ${errorMsg}`);\n\t\t\t} else\n\t\t\t\tthrow new KretaError(`Request failed with unknown status`);\n\t\t}\n\t}\n"]}
{"filename": "src/lib/Kreta.ts", "chunked_list": ["import axios, { AxiosProxyConfig, AxiosResponse } from 'axios';\n\timport moment from 'moment';\n\timport {\n\t\tAnnouncedTest,\n\t\tClassAverage, ClassMaster,\n\t\tConfigurationDescriptor,\n\t\tEvaluation,\n\t\tGroup,\n\t\tHomework,\n\t\tInstitute, Institution, KretaOptions, LepEvent,\n", "\tLesson,\n\t\tNote,\n\t\tNoticeBoardItem,\n\t\tOmission, PreBuiltAuthenticationToken, RequestAnnouncedTestsOptions, RequestClassAveragesOptions,\n\t\tRequestDateRangeOptions,\n\t\tRequestDateRangeRequiredOptions,\n\t\tRequestHomeWorkOptions,\n\t\tSchoolYearCalendarEntry,\n\t\tStudent,\n\t\tSubjectAverage, TimeTableWeek, API, Endpoints\n", "} from '../types';\n\timport { Authentication } from './Authentication';\n\timport dynamicValue from '../utils/dynamicValue';\n\timport Administration from './Administration';\n\timport Global from './Global';\n\timport requireCredentials from '../decorators/requireCredentials';\n\timport tryRequest from '../utils/tryRequest';\n\timport validateDate from '../utils/validateDate';\n\timport requireParam from '../decorators/requireParam';\n\texport default class Kreta {\n", "\tprivate readonly username?: string;\n\t\tprivate readonly password?: string;\n\t\tprivate readonly institute_code?: string;\n\t\tprivate authenticate?: Authentication;\n\t\tpublic Administration?: Administration;\n\t\tpublic Global: Global;\n\t\tprivate token?: Promise<string>;\n\t\tconstructor(options?: KretaOptions) {\n\t\t\tthis.username = options?.username || '';\n\t\t\tthis.password = options?.password || '';\n", "\t\tthis.institute_code = options?.institute_code || '';\n\t\t\taxios.defaults.headers.common['User-Agent'] = 'hu.ekreta.student/1.0.5/Android/0/0';\n\t\t\tthis.Global = new Global();\n\t\t\tthis.authenticate = new Authentication({ username: this.username!, password: this.password!, institute_code: this.institute_code! });\n\t\t\tif (this.username && this.password && this.institute_code)\n\t\t\t\tthis.token = this.authenticate.getAccessToken().then((r: PreBuiltAuthenticationToken) => r.token);\n\t\t\tthis.Administration = new Administration({ username: this.username!, password: this.password!, institute_code: this.institute_code! });\n\t\t}\n\t\tpublic get _username() {\n\t\t\treturn this.username;\n", "\t}\n\t\tpublic get _password() {\n\t\t\treturn this.password;\n\t\t}\n\t\tpublic get _institute_code() {\n\t\t\treturn this.institute_code;\n\t\t}\n\t\t@requireParam('proxy.host')\n\t\t@requireParam('proxy.port')\n\t\tpublic setProxy(proxy: AxiosProxyConfig): this {\n", "\t\taxios.defaults.proxy = proxy;\n\t\t\treturn this;\n\t\t}\n\t\t@requireParam('ua')\n\t\tpublic setUserAgent(ua: string): this {\n\t\t\taxios.defaults.headers.common['User-Agent'] = ua;\n\t\t\treturn this;\n\t\t}\n\t\tprivate buildEllenorzoApiURL(endpointWithSlash: Endpoints, params?: { [key: string]: any }): string {\n\t\t\tconst urlParams: string = params ? '?' + new URLSearchParams(params).toString() : '';\n", "\t\treturn dynamicValue(API.INSTITUTE, { institute_code: this.institute_code }).toString() + '/ellenorzo/V3' + endpointWithSlash + urlParams;\n\t\t}\n\t\t@requireParam('api_key')\n\t\tpublic getInstituteList(api_key: string): Promise<Institute[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tconst config_descriptor: AxiosResponse<ConfigurationDescriptor> = await axios.get('https://kretamobile.blob.core.windows.net/configuration/ConfigurationDescriptor.json');\n\t\t\t\tawait tryRequest(axios.get(config_descriptor.data.GlobalMobileApiUrlPROD + '/api/v3/Institute', {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\tapiKey: api_key\n\t\t\t\t\t}\n", "\t\t\t}).then((r: AxiosResponse<Institute[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getStudent(): Promise<Student> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.Tanulo), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n", "\t\t\t}).then((r: AxiosResponse<Student>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getEvaluations(options?: RequestDateRangeOptions): Promise<Evaluation[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tconst ops: { datumTol?: string; datumIg?: string } = {};\n\t\t\t\tif (options?.dateFrom)\n\t\t\t\t\tops.datumTol = validateDate(moment(options.dateFrom).format('YYYY-MM-DD'));\n\t\t\t\tif (options?.dateTo)\n", "\t\t\t\tops.datumIg = validateDate(moment(options.dateTo).format('YYYY-MM-DD'));\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.Ertekelesek, ops), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<Evaluation[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getNotes(options?: RequestDateRangeOptions): Promise<Note[]> {\n", "\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tconst ops: { datumTol?: string; datumIg?: string } = {};\n\t\t\t\tif (options?.dateFrom)\n\t\t\t\t\tops.datumTol = validateDate(moment(options.dateFrom).format('YYYY-MM-DD'));\n\t\t\t\tif (options?.dateTo)\n\t\t\t\t\tops.datumIg = validateDate(moment(options.dateTo).format('YYYY-MM-DD'));\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.Feljegyzesek, ops), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n", "\t\t\t}).then((r: AxiosResponse<Note[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getAnnouncedTests(options?: RequestAnnouncedTestsOptions): Promise<AnnouncedTest[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tconst ops: { datumTol?: string; datumIg?: string, Uids?: string } = {};\n\t\t\t\tif (options?.dateFrom)\n\t\t\t\t\tops.datumTol = validateDate(moment(options.dateFrom).format('YYYY-MM-DD'));\n\t\t\t\tif (options?.dateTo)\n", "\t\t\t\tops.datumIg = validateDate(moment(options.dateTo).format('YYYY-MM-DD'));\n\t\t\t\tif (options?.uids)\n\t\t\t\t\tops.Uids = options.uids.map((uid: string | number) => uid.toString()).join(';');\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.Szamonkeresek, ops), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<AnnouncedTest[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n", "\t@requireCredentials\n\t\t@requireParam('options.dateFrom')\n\t\tpublic getHomeworks(options: RequestHomeWorkOptions): Promise<Homework[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tconst ops: { datumTol: string; datumIg?: string } = { datumTol: validateDate(moment(options.dateFrom).format('YYYY-MM-DD')) };\n\t\t\t\tif (options?.dateTo)\n\t\t\t\t\tops.datumIg = validateDate(moment(options.dateTo).format('YYYY-MM-DD'));\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.HaziFeladatok, ops), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n", "\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<Homework[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\t@requireParam('uid')\n\t\tpublic getHomework(uid: string | number): Promise<Homework> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.HaziFeladatok) + '/' + uid.toString(), {\n\t\t\t\t\theaders: {\n", "\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<Homework>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getOmissions(options?: RequestDateRangeOptions): Promise<Omission[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tconst ops: { datumTol?: string; datumIg?: string } = {};\n\t\t\t\tif (options?.dateFrom)\n", "\t\t\t\tops.datumTol = validateDate(moment(options.dateFrom).format('YYYY-MM-DD'));\n\t\t\t\tif (options?.dateTo)\n\t\t\t\t\tops.datumIg = validateDate(moment(options.dateTo).format('YYYY-MM-DD'));\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.Mulasztasok, ops), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<Omission[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n", "\t@requireCredentials\n\t\tpublic getGroups(): Promise<Group[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.OsztalyCsoportok), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<Group[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n", "\t@requireCredentials\n\t\tpublic getSubjectAverages(onfUid?: string): Promise<SubjectAverage[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.TantargyiAtlagok, { oktatasiNevelesiFeladatUid: onfUid || await this.getGroups().then((groups: Group[]) => groups[0].OktatasNevelesiFeladat.Uid) }), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<SubjectAverage[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n", "\t@requireCredentials\n\t\t@requireParam('options.dateFrom')\n\t\t@requireParam('options.dateTo')\n\t\tpublic getLessons(options: RequestDateRangeRequiredOptions): Promise<Lesson[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.OrarendElemek, {\n\t\t\t\t\tdatumTol: validateDate(moment(options.dateFrom).format('YYYY-MM-DD')),\n\t\t\t\t\tdatumIg: validateDate(moment(options.dateTo).format('YYYY-MM-DD'))\n\t\t\t\t}), {\n\t\t\t\t\theaders: {\n", "\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<Lesson[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\t@requireParam('uid')\n\t\tpublic getLesson(uid: string | number): Promise<Lesson> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.OrarendElem, { orarendElemUid: uid.toString() }), {\n", "\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<Lesson>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getNoticeBoardItems(): Promise<NoticeBoardItem[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.FaliujsagElemek), {\n", "\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<NoticeBoardItem[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getClassAverage(options?: RequestClassAveragesOptions): Promise<ClassAverage[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tconst ops: {\n", "\t\t\t\toktatasiNevelesiFeladatUid: string;\n\t\t\t\t\ttantargyUid?: string;\n\t\t\t\t} = { oktatasiNevelesiFeladatUid: options?.oktatasiNevelesiFeladatUid || await this.getGroups().then((groups: Group[]) => groups[0].OktatasNevelesiFeladat.Uid) };\n\t\t\t\tif (options?.subjectUid)\n\t\t\t\t\tops.tantargyUid = options.subjectUid;\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.OsztalyCsoportAtlag, ops), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<ClassAverage[]>) => resolve(r.data)));\n", "\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getInstitute(): Promise<Institution> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.Intezmenyek), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<Institution>) => resolve(r.data)));\n", "\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\t@requireParam('uids')\n\t\tpublic getClassMasters(uids: string[] | number[]): Promise<ClassMaster[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.Osztalyfonokok, { Uids: uids.map((u: string | number) => u.toString()).join(';') }), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n", "\t\t\t}).then((r: AxiosResponse<ClassMaster[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\t@requireParam('options.dateFrom')\n\t\t@requireParam('options.dateTo')\n\t\tpublic getTimeTableWeeks(options: RequestDateRangeRequiredOptions): Promise<TimeTableWeek[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.OrarendHetek, {\n\t\t\t\t\torarendElemKezdoNapDatuma: validateDate(moment(options.dateFrom).format('YYYY-MM-DD')),\n", "\t\t\t\torarendElemVegNapDatuma: validateDate(moment(options.dateTo).format('YYYY-MM-DD'))\n\t\t\t\t}), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<TimeTableWeek[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getLepEvents(): Promise<LepEvent[]> {\n", "\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.Eloadasok), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<LepEvent[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getSchoolYearCalendar(): Promise<SchoolYearCalendarEntry[]> {\n", "\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.TanevNaptar), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<SchoolYearCalendarEntry[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getDeviceGivenState(): Promise<boolean> {\n", "\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildEllenorzoApiURL(Endpoints.EszkozAllapot), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<boolean>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t}\n"]}
{"filename": "src/lib/Global.ts", "chunked_list": ["import axios, { AxiosResponse } from 'axios';\n\timport { API, Endpoints, InstituteGlobal } from '../types';\n\timport tryRequest from '../utils/tryRequest';\n\texport default class Global {\n\t\tconstructor() {\n\t\t}\n\t\tpublic getInstituteList(): Promise<InstituteGlobal[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(API.GLOBAL + Endpoints.PublikusIntezmenyek, {\n\t\t\t\t\theaders: {\n", "\t\t\t\t\t'api-version': 'v1'\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<InstituteGlobal[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t}\n"]}
{"filename": "src/lib/Authentication.ts", "chunked_list": ["import {\n\t\tAuthenticationFields,\n\t\tAuthenticationResponse,\n\t\tRequestRefreshTokenOptions,\n\t\tNonceHashOptions,\n\t\tAPI,\n\t\tEndpoints, AccessToken, PreBuiltAuthenticationToken\n\t} from '../types';\n\timport axios, { AxiosProxyConfig, AxiosResponse } from 'axios';\n\timport { createHmac } from 'node:crypto';\n", "import KretaError from './errors/KretaError';\n\timport requireParam from '../decorators/requireParam';\n\timport tryRequest from '../utils/tryRequest';\n\timport requireCredentials from '../decorators/requireCredentials';\n\texport class Authentication {\n\t\tprivate readonly username: string;\n\t\tprivate readonly password: string;\n\t\tprivate readonly institute_code: string;\n\t\tprivate readonly client_id: string = 'kreta-ellenorzo-mobile-android';\n\t\tprivate readonly grant_type: string = 'password';\n", "\tprivate readonly auth_policy_version: string = 'v2';\n\t\tconstructor(options: AuthenticationFields) {\n\t\t\tthis.username = options.username;\n\t\t\tthis.password = options.password;\n\t\t\tthis.institute_code = options.institute_code;\n\t\t}\n\t\tpublic get _username() {\n\t\t\treturn this.username;\n\t\t}\n\t\tpublic get _password() {\n", "\t\treturn this.password;\n\t\t}\n\t\tpublic get _institute_code() {\n\t\t\treturn this.institute_code;\n\t\t}\n\t\t@requireParam('proxy.host')\n\t\t@requireParam('proxy.port')\n\t\tpublic setProxy(proxy: AxiosProxyConfig): this {\n\t\t\taxios.defaults.proxy = proxy;\n\t\t\treturn this;\n", "\t}\n\t\t@requireParam('ua')\n\t\tpublic setUserAgent(ua: string): this {\n\t\t\taxios.defaults.headers.common['User-Agent'] = ua;\n\t\t\treturn this;\n\t\t};\n\t\t@requireCredentials\n\t\tprivate authenticate(options: AuthenticationFields): Promise<AuthenticationResponse> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tconst nonce_key: string = await this.getNonce();\n", "\t\t\tconst hash: string = await this.getNonceHash({\n\t\t\t\t\tnonce: nonce_key,\n\t\t\t\t\tinstitute_code: options.institute_code,\n\t\t\t\t\tusername: options.username\n\t\t\t\t});\n\t\t\t\tawait tryRequest(axios.post(API.IDP + Endpoints.Token, {\n\t\t\t\t\tinstitute_code: options.institute_code,\n\t\t\t\t\tusername: options.username,\n\t\t\t\t\tpassword: options.password,\n\t\t\t\t\tgrant_type: this.grant_type,\n", "\t\t\t\tclient_id: this.client_id\n\t\t\t\t}, {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded',\n\t\t\t\t\t\t'X-Authorizationpolicy-Nonce': nonce_key,\n\t\t\t\t\t\t'X-Authorizationpolicy-Key': hash,\n\t\t\t\t\t\t'X-Authorizationpolicy-Version': this.auth_policy_version,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<AuthenticationResponse>) => resolve(r.data)));\n\t\t\t});\n", "\t}\n\t\tprivate getNonce(): Promise<string> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(API.IDP + Endpoints.Nonce).then((r: AxiosResponse<string>) => resolve(r.data.toString())));\n\t\t\t});\n\t\t}\n\t\tprivate getNonceHash(options: NonceHashOptions): Promise<string> {\n\t\t\treturn new Promise((resolve): void => {\n\t\t\t\tconst buffer_bytes: Buffer = Buffer.from(options.institute_code.toUpperCase() + options.nonce + options.username.toUpperCase(), 'utf8');\n\t\t\t\tconst hash: Buffer = createHmac('sha512', Buffer.from([98, 97, 83, 115, 120, 79, 119, 108, 85, 49, 106, 77])).update(buffer_bytes).digest();\n", "\t\t\treturn resolve(hash.toString('base64'));\n\t\t\t});\n\t\t}\n\t\tprivate async returnTokens(): Promise<AccessToken> {\n\t\t\treturn await this.authenticate({\n\t\t\t\tusername: this.username,\n\t\t\t\tpassword: this.password,\n\t\t\t\tinstitute_code: this.institute_code\n\t\t\t}).then((r: AuthenticationResponse): AccessToken => {\n\t\t\t\treturn { access_token: r.access_token, refresh_token: r.refresh_token, token_type: r.token_type };\n", "\t\t}).catch((): { access_token: null; refresh_token: null; token_type: null } => {\n\t\t\t\treturn { access_token: null, refresh_token: null, token_type: null };\n\t\t\t});\n\t\t}\n\t\tpublic getAccessToken(): Promise<PreBuiltAuthenticationToken> {\n\t\t\treturn new Promise(async (resolve, reject): Promise<void> => {\n\t\t\t\tconst { access_token, refresh_token }: AccessToken = await this.returnTokens();\n\t\t\t\tif (access_token === null || refresh_token === null)\n\t\t\t\t\treturn reject(new KretaError('Failed to get access token: Invalid credentials'));\n\t\t\t\telse\n", "\t\t\t\treturn resolve({ token: 'Bearer' + ' ' + access_token, access_token, refresh_token });\n\t\t\t});\n\t\t}\n\t\t@requireParam('options.refreshToken')\n\t\t@requireParam('options.refreshUserData')\n\t\tpublic getRefreshToken(options: RequestRefreshTokenOptions): Promise<AuthenticationResponse> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tconst nonce_key: string = await this.getNonce();\n\t\t\t\tconst hash: string = await this.getNonceHash({\n\t\t\t\t\tnonce: nonce_key,\n", "\t\t\t\tinstitute_code: this.institute_code,\n\t\t\t\t\tusername: this.username\n\t\t\t\t});\n\t\t\t\tawait tryRequest(axios.post(API.IDP + Endpoints.Token, {\n\t\t\t\t\trefresh_token: options.refreshToken,\n\t\t\t\t\tinstitute_code: this.institute_code,\n\t\t\t\t\tgrant_type: 'refresh_token',\n\t\t\t\t\tclient_id: this.client_id,\n\t\t\t\t\trefresh_user_data: options.refreshUserData\n\t\t\t\t}, {\n", "\t\t\t\theaders: {\n\t\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded',\n\t\t\t\t\t\t'X-Authorizationpolicy-Key': hash,\n\t\t\t\t\t\t'X-Authorizationpolicy-Version': this.auth_policy_version,\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<AuthenticationResponse>) =>\n\t\t\t\t\tresolve(r.data)\n\t\t\t\t));\n\t\t\t});\n\t\t}\n", "}\n"]}
{"filename": "src/lib/Administration.ts", "chunked_list": ["import axios, { AxiosResponse } from 'axios';\n\timport {\n\t\tAddresseType,\n\t\tAuthenticationFields,\n\t\tCardEvent, CurrentInstitutionDetails,\n\t\tDefaultType, EmployeeDetails,\n\t\tGuardianEAdmin,\n\t\tKretaClass,\n\t\tMailboxItem, MessageLimitations,\n\t\tPreBuiltAuthenticationToken, API, AdministrationEndpoints\n", "} from '../types';\n\timport { Authentication } from './Authentication';\n\timport requireCredentials from '../decorators/requireCredentials';\n\timport tryRequest from '../utils/tryRequest';\n\timport requireParam from '../decorators/requireParam';\n\texport default class Administration {\n\t\tprivate readonly username: string;\n\t\tprivate readonly password: string;\n\t\tprivate readonly institute_code: string;\n\t\tprivate authenticate: Authentication;\n", "\tprivate token?: Promise<string>;\n\t\tconstructor(options: AuthenticationFields) {\n\t\t\tthis.username = options.username;\n\t\t\tthis.password = options.password;\n\t\t\tthis.institute_code = options.institute_code;\n\t\t\tthis.authenticate = new Authentication({ username: this.username, password: this.password, institute_code: this.institute_code });\n\t\t\tif (this.username && this.password && this.institute_code)\n\t\t\t\tthis.token = this.authenticate.getAccessToken().then((r: PreBuiltAuthenticationToken) => r.token);\n\t\t\taxios.defaults.headers['X-Uzenet-Lokalizacio'] = 'hu-HU';\n\t\t}\n", "\tpublic get _username() {\n\t\t\treturn this.username;\n\t\t}\n\t\tpublic get _password() {\n\t\t\treturn this.password;\n\t\t}\n\t\tpublic get _institute_code() {\n\t\t\treturn this.institute_code;\n\t\t}\n\t\tprivate buildUgyintezesApiURL(endpointWithSlash: AdministrationEndpoints, params?: { [key: string]: any }): string {\n", "\t\tconst urlParams: string = params ? '?' + new URLSearchParams(params).toString() : '';\n\t\t\treturn API.ADMINISTRATION + '/api/v1' + endpointWithSlash + urlParams;\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getAddresseeType(): Promise<AddresseType[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.CimzettTipusok), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n", "\t\t\t}).then((r: AxiosResponse<AddresseType[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getCaseTypes(): Promise<DefaultType[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.KerelemTipusok), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n", "\t\t\t}).then((r: AxiosResponse<DefaultType[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getTmgiCaseTypes(): Promise<DefaultType[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.TmgiIgazolasTipusok), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n", "\t\t\t}).then((r: AxiosResponse<DefaultType[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getAccessControlSystemEvents(): Promise<CardEvent[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.Esemenyek), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n", "\t\t\t}).then((r: AxiosResponse<CardEvent[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getCurrentInstitutionModules(): Promise<string[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.JelenlegiIntezmenyModulok), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n", "\t\t\t}).then((r: AxiosResponse<string[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getAddressableType(): Promise<AddresseType[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.CimezhetoTipusok), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n", "\t\t\t}).then((r: AxiosResponse<AddresseType[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\t@requireParam('addressId')\n\t\tpublic getAddressableClasses(addressId: string | number): Promise<KretaClass[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.CimezhetoOsztalyok, { cimzettKod: addressId.toString() }), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token\n", "\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<KretaClass[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getUnreadMessagesCount(): Promise<number> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.OlvasatlanokSzama), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token\n", "\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<number>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getMessages(): Promise<MailboxItem[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.Uzenetek), {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token\n", "\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<MailboxItem[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\t@requireParam('id')\n\t\tpublic getMessage(id: string | number): Promise<MailboxItem> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.Uzenet) + '/' + id.toString(), {\n\t\t\t\t\theaders: {\n", "\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<MailboxItem>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getAddressableSzmkRepesentative(): Promise<GuardianEAdmin[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.CimezhetoSzmkKepviselok), {\n\t\t\t\t\theaders: {\n", "\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<GuardianEAdmin[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getMessageLimitations(): Promise<MessageLimitations> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.UzenetLimitacio), {\n\t\t\t\t\theaders: {\n", "\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<MessageLimitations>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getAdministrators(): Promise<EmployeeDetails[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.Adminisztratorok), {\n\t\t\t\t\theaders: {\n", "\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<EmployeeDetails[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getDirectors(): Promise<EmployeeDetails[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.Igazgatok), {\n\t\t\t\t\theaders: {\n", "\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<EmployeeDetails[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getClassMasters(): Promise<EmployeeDetails[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.Osztalyfonokok), {\n\t\t\t\t\theaders: {\n", "\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<EmployeeDetails[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getTeachers(): Promise<EmployeeDetails[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.Oktatok), {\n\t\t\t\t\theaders: {\n", "\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<EmployeeDetails[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\t@requireParam('classId')\n\t\tpublic getAddressableGuardiansForClass(classId: string | number): Promise<GuardianEAdmin[]> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.CimezhetoTanuloSzulok) + '/' + classId.toString(), {\n", "\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<GuardianEAdmin[]>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t\t@requireCredentials\n\t\tpublic getCurrentInstitutionDetails(): Promise<CurrentInstitutionDetails> {\n\t\t\treturn new Promise(async (resolve): Promise<void> => {\n\t\t\t\tawait tryRequest(axios.get(this.buildUgyintezesApiURL(AdministrationEndpoints.JelenlegiIntezmeny), {\n", "\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': await this.token\n\t\t\t\t\t}\n\t\t\t\t}).then((r: AxiosResponse<CurrentInstitutionDetails>) => resolve(r.data)));\n\t\t\t});\n\t\t}\n\t}\n"]}
{"filename": "src/lib/errors/KretaError.ts", "chunked_list": ["export default class KretaError extends Error {\n\t\tconstructor(message: string) {\n\t\t\tsuper(message);\n\t\t\tthis.name = 'KretaError';\n\t\t}\n\t}\n"]}
{"filename": "src/decorators/requireCredentials.ts", "chunked_list": ["import Kreta from '../lib/Kreta';\n\timport Administration from '../lib/Administration';\n\timport KretaError from '../lib/errors/KretaError';\n\texport default function requireCredentials(target: any, propertyName: string, descriptor: PropertyDescriptor): PropertyDescriptor {\n\t\tconst originalMethod = descriptor.value;\n\t\tdescriptor.value = function (...args: any[]) {\n\t\t\tconst instance: Kreta | Administration = this as Kreta || Administration;\n\t\t\tif (!instance._username || !instance._password || !instance._institute_code)\n\t\t\t\tthrow new KretaError('Missing required credentials');\n\t\t\treturn originalMethod.call(this, ...args);\n", "\t};\n\t\treturn descriptor;\n\t}\n"]}
{"filename": "src/decorators/requireParam.ts", "chunked_list": ["import KretaError from '../lib/errors/KretaError';\n\texport default function requireParam(param: string) {\n\t\treturn function (target: any, propertyKey: string, descriptor: PropertyDescriptor): void {\n\t\t\tconst originalMethod = descriptor.value;\n\t\t\tdescriptor.value = function (...args: any[]) {\n\t\t\t\tconst value = args[0];\n\t\t\t\tif (value === null || value === '' || value === undefined)\n\t\t\t\t\tthrow new KretaError(`'${param}' is a required parameter`);\n\t\t\t\tif (typeof value === 'object') {\n\t\t\t\t\tif (Array.isArray(value)) {\n", "\t\t\t\t\tif (value.length === 0)\n\t\t\t\t\t\t\tthrow new KretaError(`'${param}' must not be an empty array`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst [objName, propName]: string[] = param.split('.');\n\t\t\t\t\t\tif (propName != null && value[propName] == null)\n\t\t\t\t\t\t\tthrow new KretaError(`'${propName}' is a required property in '${objName}'`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn originalMethod.apply(this, args);\n\t\t\t};\n", "\t};\n\t}\n"]}
