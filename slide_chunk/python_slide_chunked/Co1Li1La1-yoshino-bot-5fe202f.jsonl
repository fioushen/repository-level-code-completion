{"filename": "main.py", "chunked_list": ["import fnbot\n\n# Importing configuration files\n# fnbot.load_config_json(\"./pybot.json\")\n# fnbot.load_config_toml(\"./pybot.toml\")\nfnbot.load_config_toml(\"./pybot.toml\")\n\n# Create a new configuration file `config.toml` or `config.json`\n# to replace `pybot.toml` or `pybot.json`\n# fnbot.load_config_json(\"./config.json\")", "# to replace `pybot.toml` or `pybot.json`\n# fnbot.load_config_json(\"./config.json\")\n# fnbot.load_config_toml(\"./config.toml\")\n\n\n# Importing plugins\n# fnbot.insert_plugin(\"debug\", \"./plugins\")\n# fnbot.insert_plugin([\"debug\", ], \"./plugins\")\n# fnbot.insert_plugins_dir(\"./plugins\",)\n# containing _plugin as follows:", "# fnbot.insert_plugins_dir(\"./plugins\",)\n# containing _plugin as follows:\n# fnbot.insert_the_plugin(\"_debug\", \"./plugins\")\n# fnbot.insert_the_plugin([\"_debug\", ], \"./plugins\")\nfnbot.insert_plugins_dir(\"./plugins\",)\n\n# Create a new folder `plugin` to replace `plugins`\n# fnbot.insert_plugins_dir(\"./plugin\",)\n\n", "\n\n\nif \"__main__\" == __name__:\n    fnbot.run()\n\n\n"]}
{"filename": "pybot.py", "chunked_list": ["# Similar to `config.json or config.toml`\n\n"]}
{"filename": "plugins/simple_plugin.py", "chunked_list": ["import time\n\nfrom fnbot import ciallo\nfrom fnbot import Message\nfrom fnbot import Send\n\n\n\n@Message.insert_msg()\n@ciallo.grace('/help')", "@Message.insert_msg()\n@ciallo.grace('/help')\nasync def _(msg_type:str, num_type:str, rev:'Message'):\n    if ciallo.match(rev.msg, [\"\u83dc\u5355\", \"\u5e2e\u52a9\", \"\u57fa\u672c\u529f\u80fd\"]):\n        msg = \"\u6682\u65f6\u6ca1\u6709~\"\n        Send(rev).send_msg(msg_type, num_type, msg)\n\n\n@Message.insert_msg()\n@ciallo.grace('/time')", "@Message.insert_msg()\n@ciallo.grace('/time')\nasync def _(msg_type:str, num_type:str, rev:'Message'):\n    if ciallo.match(rev.msg, ['\u65f6\u95f4', '/\u65f6\u95f4']):\n        wl = \"\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u5929\"\n        weekday = wl[time.localtime().tm_wday]\n        now_time = time.strftime(\"%Y-%m-%d %H:%M:%S\")\n        msg = f\"{now_time}\\t\u661f\u671f{weekday}\"\n        Send(rev).send_msg(msg_type, num_type, msg)"]}
{"filename": "plugins/recall_plugin.py", "chunked_list": ["import asyncio\n\nfrom fnbot import ciallo\nfrom fnbot import Message\nfrom fnbot import Send\n\n\n\n@Message.insert_notice()\n@ciallo.grace('/group_recall')", "@Message.insert_notice()\n@ciallo.grace('/group_recall')\nasync def _(msg_type:str, num_type:str, rev:'Message'):\n    if rev.notice_type == \"group_recall\" and all((\n        rev.operator_id != rev.self_id, rev.user_id != rev.self_id,\n    )):\n        recall_rev = Send(rev).get_msg(rev.msg_id)['data']\n        recall_rev = Message(recall_rev)\n        recall_msg = recall_rev.msg\n\n        msg = f\"[CQ:poke,qq={recall_rev.sender_user_id}]\"\n        Send(rev).send_msg(msg_type, num_type, msg)\n\n        msg = recall_msg\n        msg_id = Send(rev).send_msg(msg_type, num_type, msg)\n\n        @ciallo\n        async def task():\n            await asyncio.sleep(3)\n            Send(rev).delete_msg(msg_id)\n            await task.cancel()\n        await task.start(rev)", "\n\n@Message.insert_notice()\n@ciallo.grace('/private_recall')\nasync def _(rev:\"Message\"):\n    if rev.notice_type == \"friend_recall\":\n        recall_rev = Send(rev).get_msg(rev.msg_id)['data']\n        recall_rev = Message(recall_rev)\n        _qq = recall_rev.sender_user_id\n        msg = f\"{_qq}\\t\\t\\t\u7684\u6d88\u606f\u5728\u79c1\u804a\u4e2d\u88ab\u64a4\u56de\u4e86:\\n\\n{recall_rev.msg}\"\n        Send(rev).send_msg(\"private\",ciallo(c=rev).super_qq,msg)"]}
{"filename": "plugins/reread_plugin.py", "chunked_list": ["import random\nimport asyncio\n\nfrom fnbot import ciallo\nfrom fnbot import Message\nfrom fnbot import Send\n\n\n\nrev_dict:dict = {}", "\nrev_dict:dict = {}\nawt_group:list = []\n\n@Message.insert_group()\n@ciallo.grace('/group_fudu')\nasync def _(msg_type:str, num_type:str, rev:'Message'):\n    num_type_msg_list = rev_dict.get(num_type, [])\n    num_type_msg_list.append(rev.msg)\n    if len(num_type_msg_list) >3: num_type_msg_list.pop(0)", "    num_type_msg_list.append(rev.msg)\n    if len(num_type_msg_list) >3: num_type_msg_list.pop(0)\n    rev_dict.update({num_type:num_type_msg_list})\n\n    if len(num_type_msg_list) == 3 and all((\n        num_type_msg_list[0] == num_type_msg_list[1],\n        num_type_msg_list[1] == num_type_msg_list[2],\n        num_type not in awt_group, rev.user_id != rev.self_id,\n    )): awt_group.append(num_type)\n    else: return", "\n    @ciallo\n    async def task():\n        msg = num_type_msg_list[0]\n        Send(rev).send_msg(msg_type, num_type, msg)\n        probability = random.uniform(0.88, 88.88)\n        while True:\n            awtrev = await task.awt_all_rev()\n            if any((awtrev.group_id != rev.group_id,\n                awtrev.user_id == rev.self_id,)): continue\n            if awtrev.msg == msg:\n                break_probability = random.uniform(0.88, 100.00)\n                if break_probability < probability or probability >= 100:\n                    break_msg = \"\u6253\u65ad\u65bd\u6cd5~\"\n                    if msg == break_msg: break_msg = \"~\u6cd5\u65bd\u65ad\u6253\"\n                    Send(rev).send_msg(msg_type,num_type,break_msg)\n                    await task.cancel()\n                else:\n                    Send(rev).send_msg(msg_type, num_type, msg)\n                    probability += random.uniform(0.66, 33.33)\n                    if probability >= 100: probability = 100.00\n                    await asyncio.sleep(1)\n            else:\n                await task.cancel()", "            if any((awtrev.group_id != rev.group_id,\n                awtrev.user_id == rev.self_id,)): continue\n            if awtrev.msg == msg:\n                break_probability = random.uniform(0.88, 100.00)\n                if break_probability < probability or probability >= 100:\n                    break_msg = \"\u6253\u65ad\u65bd\u6cd5~\"\n                    if msg == break_msg: break_msg = \"~\u6cd5\u65bd\u65ad\u6253\"\n                    Send(rev).send_msg(msg_type,num_type,break_msg)\n                    await task.cancel()\n                else:\n                    Send(rev).send_msg(msg_type, num_type, msg)\n                    probability += random.uniform(0.66, 33.33)\n                    if probability >= 100: probability = 100.00\n                    await asyncio.sleep(1)\n            else:\n                await task.cancel()", "    await task.start(rev)\n    awt_group.remove(num_type)"]}
{"filename": "plugins/scheduled_task.py", "chunked_list": ["import time\n\nfrom fnbot import ciallo\nfrom fnbot import Message\nfrom fnbot import Send\n\n\n\nasync def group_sign():\n    dev_list = [_ for _ in ciallo(c=None).cfginfo.keys()]\n    for _ in dev_list:\n        for group_id in ciallo(c=_).group_list:\n            Send(_).send_group_sign(group_id)", "async def group_sign():\n    dev_list = [_ for _ in ciallo(c=None).cfginfo.keys()]\n    for _ in dev_list:\n        for group_id in ciallo(c=_).group_list:\n            Send(_).send_group_sign(group_id)\n\nasync def task_start():\n    while True:\n        h= int(time.strftime(\"%H\"))\n        m= int(time.strftime(\"%M\"))", "        h= int(time.strftime(\"%H\"))\n        m= int(time.strftime(\"%M\"))\n        s= int(time.strftime(\"%S\"))\n        awt_time = 86400 -60 - h*3600 - m*60 -s\n        if awt_time >= 0:\n            time.sleep(awt_time)\n        else:\n            time.sleep(s + 0.1)\n            await group_sign()\n", "\n\n\n@Message.insert()\n@ciallo.grace()\nasync def _():\n    await task_start()\n\n\n", "\n"]}
{"filename": "plugins/basic_notice_plugin.py", "chunked_list": ["\n\nfrom fnbot import ciallo\nfrom fnbot import Message\nfrom fnbot import Send\n\n\n\n@Message.insert_notice()\n@ciallo.grace('/upload_group_file')", "@Message.insert_notice()\n@ciallo.grace('/upload_group_file')\nasync def _(msg_type:str, num_type:str, rev:\"Message\"):\n    if rev.notice_type == \"group_upload\":\n        msg = f\"[CQ:poke,qq={rev.qq}]\"\n        Send(rev).send_msg(msg_type, num_type, msg)\n\n\n@Message.insert_notice()\n@ciallo.grace('/group_member_decrease')", "@Message.insert_notice()\n@ciallo.grace('/group_member_decrease')\nasync def _(msg_type:str, num_type:str, rev:\"Message\"):\n    if rev.notice_type == \"group_decrease\" and rev.operator_id == rev.user_id:\n        msg = \"\u6709\u4e2a\u4eba\u88ab\u00b7\u00b7\u00b7\u5413\u8dd1\u4e86\uff01\"\n        Send(rev).send_msg(msg_type, num_type, msg)\n\n\n@Message.insert_notice()\n@ciallo.grace('/group_member_increase')", "@Message.insert_notice()\n@ciallo.grace('/group_member_increase')\nasync def _(msg_type:str, num_type:str, rev:\"Message\"):\n    if rev.notice_type == \"group_increase\":\n        msg=(\n            f\"[CQ:at,qq={rev.qq}]\\n\"\n            f\"\u7ec8\u4e8e\u7b49\u5230\u4f60\u4e86~\"\n        )\n        Send(rev).send_msg(msg_type,num_type,msg)"]}
{"filename": "plugins/basic_request_plugin.py", "chunked_list": ["\n\nfrom fnbot import ciallo\nfrom fnbot import Message\nfrom fnbot import Send\n\n\n\n@Message.insert_request()\n@ciallo.grace('/add_friend')", "@Message.insert_request()\n@ciallo.grace('/add_friend')\nasync def _(rev:\"Message\"):\n    if rev.request_type == \"friend\":\n        Send(rev).set_friend_add_request(rev.flag, True)\n"]}
{"filename": "plugins/today_in_history/__init__.py", "chunked_list": ["import os\nimport json\nimport time\n\nfrom fnbot import ciallo\nfrom fnbot import Message\nfrom fnbot import Send\n\n\n", "\n\ncurrent_file_path = ciallo.get_current_path(__file__)\npath_src = current_file_path + '/src'\npath_lssdjt = path_src\n\n\n\n@Message.insert_msg()\n@ciallo.grace('/today_in_history')", "@Message.insert_msg()\n@ciallo.grace('/today_in_history')\nasync def _(msg_type:str, num_type:str, rev:'Message'):\n    if ciallo.match(rev.msg, ['\u5386\u53f2\u4e0a\u7684\u4eca\u5929', '/\u5386\u53f2\u4e0a\u7684\u4eca\u5929']):\n        now_time = time.strftime(\"%Y-%m-%d\")\n        month_now = time.strftime('%m')\n        day_now = time.strftime('%d')\n        fp = path_lssdjt + f\"/{month_now}-{day_now}.json\"\n        with open(fp, \"r\", encoding=\"utf-8\") as f:\n            day_dict:dict = json.load(f)\n\n        msg_list = [now_time]\n        msg_list += [key + \":\\n\" + value for key,value in day_dict.items()]\n        msg:list = ciallo.forward_msg(rev.time, rev.self_id, msg_list)\n        Send(rev).send_forward_msg(msg_type, num_type, msg)", "\n\n"]}
{"filename": "plugins/questions_and_answers/config.py", "chunked_list": ["from fnbot import ciallo\n\ncurrent_file_path = ciallo.get_current_path(__file__)\npath_src = current_file_path + '/src'\npath_riddle = path_src + '/riddle.json'\npath_fable = path_src + '/fable.json'\npath_twist = path_src + '/twist.json'"]}
{"filename": "plugins/questions_and_answers/__init__.py", "chunked_list": ["import json\nimport time\nimport random\nimport asyncio\nfrom threading import Lock\n\nfrom fnbot import ciallo\nfrom fnbot import Message\nfrom fnbot import Send\n", "from fnbot import Send\n\nfrom .config import path_riddle, path_fable, path_twist\n\n\n\n# riddle\ndef riddle_yield_function(_fp:str):\n    with open(_fp, \"r\", encoding=\"utf-8\") as f:\n        _dict:dict = json.load(f)\n        _list = list(_dict.keys())\n    while True:\n        random.shuffle(_list)\n        for i in _list: yield (i, _dict[i])", "\nriddle_src_generator = riddle_yield_function(path_riddle)\n\nriddle_lock = Lock()\n\ndef riddle_next_function():\n    with riddle_lock: return next(riddle_src_generator)\n\n\n# fable\ndef fable_yield_function(_fp:str):\n    with open(_fp, \"r\", encoding=\"utf-8\") as f:\n        _dict:dict = json.load(f)\n        _list = list(_dict.keys())\n    while True:\n        random.shuffle(_list)\n        for i in _list: yield (i, _dict[i])", "\n# fable\ndef fable_yield_function(_fp:str):\n    with open(_fp, \"r\", encoding=\"utf-8\") as f:\n        _dict:dict = json.load(f)\n        _list = list(_dict.keys())\n    while True:\n        random.shuffle(_list)\n        for i in _list: yield (i, _dict[i])\n", "\nfable_generator = fable_yield_function(path_fable)\n\nfable_lock = Lock()\n\ndef fable_next_function():\n    with fable_lock: return next(fable_generator)\n\n\n# twist\ndef tist_yield_function(_fp:str):\n    with open(_fp, \"r\", encoding=\"utf-8\") as f:\n        _dict:dict = json.load(f)\n        _list = list(_dict.keys())\n    while True:\n        random.shuffle(_list)\n        for i in _list: yield (i, _dict[i])", "\n# twist\ndef tist_yield_function(_fp:str):\n    with open(_fp, \"r\", encoding=\"utf-8\") as f:\n        _dict:dict = json.load(f)\n        _list = list(_dict.keys())\n    while True:\n        random.shuffle(_list)\n        for i in _list: yield (i, _dict[i])\n", "\ntwist_generator = tist_yield_function(path_twist)\n\ntwist_lock = Lock()\n\ndef twist_next_function():\n    with twist_lock: return next(twist_generator)\n\n\n", "\n\n@Message.insert_msg()\n@ciallo.grace('/q and a')\nasync def _(msg_type:str, num_type:str, rev:'Message'):\n    if ciallo.match(rev.msg, [\"\u5b57\u8c1c\", \"\u6b47\u540e\u8bed\", \"\u8111\u7b4b\u6025\u8f6c\u5f2f\",]):\n        if rev.msg == \"\u5b57\u8c1c\": issue, answer = riddle_next_function()\n        elif rev.msg == \"\u6b47\u540e\u8bed\": issue, answer = fable_next_function()\n        else: issue, answer = twist_next_function()\n\n        wl = \"\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u5929\"\n        weekday = wl[time.localtime().tm_wday]\n        now_time = time.strftime(\"%Y-%m-%d %H:%M:%S\")\n\n        msg = (\n            f\"[CQ:at,qq={str(rev.qq)}]\\n\"\n            f\"\u4f60\u6709\u4e09\u5206\u949f\u7684\u65f6\u95f4\u56de\u7b54\u5982\u4e0b\u95ee\u9898(\u5171\u4e09\u6b21\u673a\u4f1a)\\n\"\n            f\"\u5f53\u524d\u65f6\u95f4\uff1a\\n\"\n            f\"{now_time}\\t\u661f\u671f{weekday}\"\n        )\n        msg = ciallo.compat_msg(msg, msg_type, rev)\n        Send(rev).send_msg(msg_type, num_type, msg)\n\n        msg = (\n            f\"[CQ:reply,id={rev.msg_id}]\"\n            f\"[CQ:at,qq={str(rev.qq)}]\"\n            f\"{issue}\"\n        )\n        msg = ciallo.compat_msg(msg, msg_type, rev)\n        Send(rev).send_msg(msg_type, num_type, msg)\n\n        @ciallo\n        async def schedule(msg_type:str, num_type:str, rev:'Message'):\n            while True:\n                awtrev:'Message' = await schedule.awt_special_rev()\n                schedule.counter += 1\n                if all((\n                    awtrev.msg == '\u7b54\u6848',\n                    any((\n                        ciallo.is_bot_admin(awtrev),\n                        ciallo.is_group_admin(awtrev),\n                    )),\n                )):\n                    schedule.counter -= 1\n                    msg = str(answer)\n                    Send(rev).send_msg(msg_type, num_type, msg)\n                elif awtrev.msg == answer:\n                    msg=(\n                        f\"[CQ:at,qq={str(rev.qq)}]\\n\"\n                        f\"\u606d\u559c\u4f60\u56de\u7b54\u6b63\u786e\uff01\uff01\uff01\"\n                    )\n                    msg = ciallo.compat_msg(msg, msg_type, rev)\n                    Send(rev).send_msg(msg_type, num_type, msg)\n                    await schedule.cancel()\n                elif schedule.counter >= 3:\n                    msg = (\n                        f\"[CQ:at,qq={str(rev.qq)}]\\n\"\n                        f\"\u56de\u7b54\u6b21\u6570\u8d85\u8fc7\u4e0a\u9650!!!\\n\"\n                        f\"\u7b54\u6848\u662f:\\n\\n\"\n                        f\"{answer}\"\n                    )\n                    msg = ciallo.compat_msg(msg, msg_type, rev)\n                    Send(rev).send_msg(msg_type, num_type, msg)\n                    await schedule.cancel()\n                else:\n                    msg=(\n                        f\"[CQ:at,qq={str(rev.qq)}]\\n\"\n                        f\"\u7b54\u6848\u4f3c\u4e4e\u4e0d\u662f\u8fd9\u4e2a\uff01\uff01\uff01\"\n                    )\n                    msg = ciallo.compat_msg(msg, msg_type, rev)\n                    Send(rev).send_msg(msg_type, num_type, msg)\n\n        @schedule.awtwait\n        async def schedule(msg_type:str, num_type:str, rev:'Message'):\n            while True:\n                awtexcrev = await schedule.awt_exc_rev()\n                if all((\n                    awtexcrev.msg == '\u7b54\u6848',\n                    any((\n                        ciallo.is_bot_admin(awtexcrev),\n                        ciallo.is_group_admin(awtexcrev),\n                    )),\n                )):\n                    msg = answer\n                    Send(rev).send_msg(msg_type, num_type, msg)\n\n        @schedule.awtdecline\n        async def schedule(msg_type:str, num_type:str, rev:'Message'):\n            await asyncio.sleep(180)\n            msg = (\n                f\"[CQ:at,qq={str(rev.qq)}]\\n\"\n                f\"\u7b49\u5f85\u8d85\u65f6\uff01\uff01\uff01\\n\"\n                f\"\u7b54\u6848\u662f:\\n\\n\"\n                f\"{answer}\"\n            )\n            msg = ciallo.compat_msg(msg, msg_type, rev)\n            Send(rev).send_msg(msg_type, num_type, msg)\n            await schedule.cancel()\n        await schedule.start(rev)"]}
{"filename": "fnbot/__main__.py", "chunked_list": [""]}
{"filename": "fnbot/__init__.py", "chunked_list": ["r\"\"\"This module is for quick import\n\nFor the convenience of use,this module imports some content from sub-modules,\nthe following content can be imported directly through this module\n\"\"\"\nfrom .yoshinobot import run as run\nfrom .yoshinobot import load_config_toml as load_config_toml\nfrom .yoshinobot import load_config_json as load_config_json\nfrom .yoshinobot import insert_plugin as insert_plugin\nfrom .yoshinobot import insert_plugins_dir as insert_plugins_dir", "from .yoshinobot import insert_plugin as insert_plugin\nfrom .yoshinobot import insert_plugins_dir as insert_plugins_dir\nfrom .yoshinobot import insert_the_plugin as insert_the_plugin\n\nfrom .yoshinobot import ciallo as ciallo\nfrom .yoshinobot import Config as Config\nfrom .yoshinobot import Receive as Receive\nfrom .yoshinobot import Send as Send\nfrom .yoshinobot import Message as Message\n", "from .yoshinobot import Message as Message\n\nfrom .yoshinobot import YOSHINO as YOSHINO\n\nfrom .__version__ import (\n    __title__,\n    __version__,\n    __description__,\n    __url__,\n    __author__,", "    __url__,\n    __author__,\n    __author_email__,\n)\n\nCIALLO = \"CIALLO\""]}
{"filename": "fnbot/__version__.py", "chunked_list": ["__title__ = \"fnbot\"\n__version__ = \"1.2.16\"\n__description__ = \"yoshino bot\"\n__url__ = \"https://github.com/Co1Li1La1/yoshino-bot\"\n__author__ = \"Co1Li1La1\"\n__author_email__ = \"mrhblfx@gmail.com\""]}
{"filename": "fnbot/yoshinobot/bot_insert.py", "chunked_list": ["from typing import overload\n\nfrom .bot import BotInsert\n\n__all__ = ( \"Insert\",\n            \"InsertInit\", \"InsertMessage\",\n            \"InsertPrivate\", \"InsertGroup\",\n            \"InsertNotice\", \"InsertRequest\",\n\n            \"get_insert_plugins\"", "\n            \"get_insert_plugins\"\n)\n\n\n\ndef _is_legal_decorated(f) -> bool:\n    return all((\n        getattr(f.__code__, 'co_flags', 0) in [147, 195],\n    ))", "\ndef _update_manage_component(_insert_type:str, _f):\n    f_list:list = Insert.manage_component_dict.get(_insert_type, [])\n    f_list.append(_f)\n    Insert.manage_component_dict.update({_insert_type:f_list})\n\nclass Insert(BotInsert):\n    \"\"\"\n    Class Properties:\n    ```\n        insert_type:str = \"insert\"\n        manage_component_dict: dict{\n            'insert_type': list[function],\n        }\n    ```\n    \"\"\"\n    insert_type:str = \"insert\"\n    manage_component_dict:dict = {}\n    \"\"\"\n    ```\n        dict{\n            'insert_type': list[function],\n        }\n    ```\n    \"\"\"\n    def __new__(cls, _name:str, _bases:tuple, _dict:dict):\n        return type.__new__(cls, _name, _bases, _dict)\n\n    def __init__(self, _name:str, _bases:tuple, _dict:dict):\n        if _name in ['InsertInit']: self.insert_type = 'init'\n        elif _name in ['InsertMessage']: self.insert_type = 'message'\n        elif _name in ['InsertPrivate']: self.insert_type = 'private'\n        elif _name in ['InsertGroup']: self.insert_type = 'group'\n        elif _name in ['InsertNotice']: self.insert_type = 'notice'\n        elif _name in ['InsertRequest']: self.insert_type = 'request'\n        return type.__init__(self, _name, _bases, _dict)\n\n\n    @overload\n    @classmethod\n    def manage(cls): ...\n    @overload\n    @classmethod\n    def manage(cls, _dev:list, /): ...\n    @overload\n    @classmethod\n    def manage(cls, *, _bool:bool): ...\n    @overload\n    @classmethod\n    def manage(cls,\n        _dev:list = [], _group:list = [], _bool:bool = True, _num:int = 0,\n    ): ...\n\n    @classmethod\n    def manage(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        def decorator(f):\n            assert _is_legal_decorated(f)\n            assert isinstance(_dev, list)\n            assert isinstance(_group, list)\n            assert isinstance(_alive, bool)\n            assert isinstance(_num, int)\n            setattr(f, \"__dev__\", _dev)\n            setattr(f, \"__group__\", _group)\n            setattr(f, \"__alive__\", _alive)\n            setattr(f, \"__num__\", _num)\n            if cls.insert_type == \"message\":\n                _update_manage_component(\"private\", f)\n                _update_manage_component(\"group\", f)\n                return f\n            _update_manage_component(cls.insert_type, f)\n            return f\n        return decorator", "\n\n\nclass InsertInit(Insert, metaclass = Insert):\n    def __new__(cls): pass\nclass InsertMessage(Insert, metaclass = Insert):\n    def __new__(cls): pass\nclass InsertPrivate(Insert, metaclass = Insert):\n    def __new__(cls): pass\nclass InsertGroup(Insert, metaclass = Insert):\n    def __new__(cls): pass", "class InsertGroup(Insert, metaclass = Insert):\n    def __new__(cls): pass\nclass InsertNotice(Insert, metaclass = Insert):\n    def __new__(cls): pass\nclass InsertRequest(Insert, metaclass = Insert):\n    def __new__(cls): pass\n\n\n\ndef get_insert_plugins(_insert_type:str) -> list:\n    return Insert.manage_component_dict.get(_insert_type, [])", "\ndef get_insert_plugins(_insert_type:str) -> list:\n    return Insert.manage_component_dict.get(_insert_type, [])"]}
{"filename": "fnbot/yoshinobot/bot_plugin.py", "chunked_list": ["import os\nimport importlib\n\nfrom .bot import BotPlugin\n\nfrom .platforms import Config\n\n__all__ = ( \"insert_plugin\",\n            \"insert_plugins_dir\",\n            \"insert_the_plugin\",", "            \"insert_plugins_dir\",\n            \"insert_the_plugin\",\n)\n\n\n\nclass Plugin(BotPlugin):\n    \"\"\"\n    Class Properties:\n    ```\n        all_plugin_name: list[str]\n        inserted_plugins: dict\n    ```\n    \"\"\"\n    all_plugin_name:list = []\n    \"\"\"`list[str]`\"\"\"\n    inserted_plugins:dict = {}\n    __slots__ = ('plugin_name_list', 'relative_path_str',)\n\n    def __init__(self, _plugin_name_list:list, _relative_path_str:str):\n        self.plugin_name_list = _plugin_name_list\n        self.relative_path_str = _relative_path_str\n\n    def _relative_to_absolute(self) -> str:\n        \"\"\"\n        Returns:\n        ```\n            str: absolute path of self.relative_path_str\n        ```\n        \"\"\"\n        absolute_path:str = (\n            Config.path_pybot + \"/\" + self.relative_path_str.lstrip(\"./\").rstrip(\"/\")\n        )\n        return absolute_path\n\n    def _to_import_name(self, _name:str) -> str:\n        \"\"\"\n        Returns:\n        ```\n            str: the name to be imported\n        ```\n        \"\"\"\n        import_name:str = self.relative_path_str.lstrip(\"./\").rstrip(\"/\")\n        import_name =  \".\".join(import_name.split(\"/\")) + f\".{_name}\"\n        if import_name.endswith(\".py\"): import_name = import_name.rstrip(\".py\")\n        return import_name\n\n    def _is_legal_plugin(self, BotPlugin:str) -> bool:\n        \"\"\"\n        A legitimate plugin should have a file name or folder name that\n        does not start with `_`.\n        If it is a folder, it must contain the file `__init__.py`.\n\n        Args:\n        ```\n            _plugin_str:str    :debug_file, debug.py, debug_dir\n        ```\n        Returns:\n        ```\n            bool: Is it a plugin name that can be imported?\n        ```\n        \"\"\"\n        if any((BotPlugin.startswith('_'),)): return False\n        absolute_plugin_path:str = self._relative_to_absolute() + '/' + BotPlugin\n        return any((\n            os.path.isfile(absolute_plugin_path),\n            os.path.isfile(absolute_plugin_path + '.py'),\n            all((\n                os.path.isdir(absolute_plugin_path),\n                os.path.isfile(absolute_plugin_path + '/__init__.py'),\n            )),\n        ))\n\n    def _insert_plugin(self, _name:str):\n        plugin_list = os.listdir(self._relative_to_absolute())\n        if _name in plugin_list or _name + '.py' in plugin_list:\n            self.all_plugin_name.append(self._to_import_name(_name))\n        else:\n            raise RuntimeError(f\"Not found {_name} at all!!!\")\n\n\n    def insert_plugin_self(self):\n        plugin_list = [_ for _ in self.plugin_name_list if self._is_legal_plugin(_)]\n        for _ in plugin_list: self._insert_plugin(_)\n\n    def insert_plugins_dir(self, _exc_plugins_list:list = []):\n        plugin_dir_list:list = os.listdir(self._relative_to_absolute())\n        plugin_dir_list = [_ for _ in plugin_dir_list if self._is_legal_plugin(_)]\n        plugin_dir_list = [_ for _ in plugin_dir_list if _ not in _exc_plugins_list]\n        if plugin_dir_list == []: raise RuntimeError(\"Not found any plugin at all!!!\")\n        for _ in plugin_dir_list: self._insert_plugin(_)\n\n    def insert_the_plugin(self):\n        for _ in self.plugin_name_list: self._insert_plugin(_)", "\n\n\ndef insert_plugin(BotPlugin, _relative_path:str):\n    \"\"\"\n    Args:\n    ```\n        BotPlugin: str | list\n        _relative_path: str | None = None\n    ```\n    Usages:\n    ```\n        fnbot.insert_plugin(\"debug\", \"./plugins\")\n        fnbot.insert_plugin([\"debug\", ], \"./plugins\")\n    ```\n    \"\"\"\n    assert isinstance(BotPlugin, (str, list))\n    assert isinstance(_relative_path, str)\n    if isinstance(BotPlugin, str): BotPlugin = [BotPlugin]\n    plugin = Plugin(BotPlugin, _relative_path)\n    return plugin.insert_plugin_self()", "\ndef insert_plugins_dir(_relative_path_dir:str, _exc_plugins_list:list = []):\n    \"\"\"\n    Args:\n    ```\n        _relative_path_dir:str\n        _exc_plugins_list:list[str] = []\n    ```\n    Usages:\n    ```\n        fnbot.insert_plugins_dir(\"./plugins\")\n    ```\n    \"\"\"\n    assert isinstance(_relative_path_dir, str)\n    assert isinstance(_exc_plugins_list, list)\n    plugin = Plugin([], _relative_path_dir)\n    return plugin.insert_plugins_dir(_exc_plugins_list)", "\ndef insert_the_plugin(BotPlugin, _relative_path:str):\n    \"\"\"contain BotPlugin\n\n    Args:\n    ```\n        BotPlugin: str | list\n        _relative_path: str | None = None\n    ```\n    Usages:\n    ```\n        fnbot.insert_the_plugin(\"_debug\", \"./plugins\")\n        fnbot.insert_the_plugin([\"_debug\", ], \"./plugins\")\n    ```\n    \"\"\"\n    assert isinstance(BotPlugin, (str, list))\n    assert isinstance(_relative_path, str)\n    if isinstance(BotPlugin, str): BotPlugin = [BotPlugin]\n    plugin = Plugin(BotPlugin, _relative_path)\n    return plugin.insert_the_plugin()", "\n\n\ndef load_all_plugin():\n    for _ in Plugin.all_plugin_name:\n        module = importlib.import_module(_)\n        Plugin.inserted_plugins.update({str(module):_})\n\n\n", "\n"]}
{"filename": "fnbot/yoshinobot/_core.py", "chunked_list": ["import time\nimport asyncio\nimport threading\nfrom concurrent.futures import ThreadPoolExecutor\n\nfrom .bot_insert import get_insert_plugins\nfrom .platforms import Config\nfrom .platforms import load_all_config\nfrom .bot_plugin import load_all_plugin\nfrom .platforms import is_cq_alive", "from .bot_plugin import load_all_plugin\nfrom .platforms import is_cq_alive\nfrom .platforms import run_receive_server\nfrom .platforms import get_rev_msg\nfrom ._ciallo import schedule\n\n__all__ = \"run\",\n\n\n\nclass CoreOfInsert:\n    nonparametric_insert_type = ['init', 'insert']\n    parametric_insert_type = ['private', 'group', 'notice', 'request']\n    __slots__ = (\"insert_type\", \"to_run\",)\n\n    def __init__(self, _insert_type:str, _component_list:list):\n        self.insert_type = _insert_type\n        self.to_run = self.get_to_run(_component_list)\n        # to_run:list[function] for parametric_insert_type\n        # to_run:dict{'bot_qq':list[function]} for nonparametric_insert_type\n\n    def get_to_run(self, _component_list:list):\n        \"\"\"\n        Retuens:\n        ```\n            to_run:list[function]\n            to_run:dict{'bot_qq':list[function]}\n        ```\n        \"\"\"\n        if self.insert_type in self.nonparametric_insert_type:\n            return [_ for _ in _component_list if _.__alive__]\n        elif self.insert_type in self.parametric_insert_type:\n            to_run_dict:dict = {_:[] for _ in Config.cfginfo.keys()}\n            for _ in _component_list:\n                if [] == _.__dev__:\n                    to_run_dict = {\n                        v.append(_) or k:v for k,v in to_run_dict.items()\n                    }\n                else:\n                    for dev in _.__dev__:\n                        dev = str(dev)\n                        dev_to_list:list = to_run_dict.get(dev, [])\n                        dev_to_list.append(_)\n                        to_run_dict.update({dev:dev_to_list})\n            return to_run_dict\n\n    async def _run_core(self, _rev:dict = {}):\n        if self.insert_type in self.nonparametric_insert_type:\n            if [] != self.to_run:\n                await asyncio.gather(*[_() for _ in self.to_run])\n        elif self.insert_type in self.parametric_insert_type:\n            to_run_list:list = self.to_run.get(str(_rev.get(\"self_id\")), [])\n            to_run_list = [\n                _ for _ in to_run_list if (\n                    [] == _.__group__ or _rev.get('group_id') in _.__group__\n                )\n            ]\n            to_run_list = sorted(\n                to_run_list, key = lambda x:x.__num__, reverse = False\n            )\n            if [] != to_run_list:\n                await asyncio.gather(*[_(_rev) for _ in to_run_list])\n    def run(self, _rev:dict = {}): asyncio.run(self._run_core(_rev))", "\n\nclass CoreOfInsert:\n    nonparametric_insert_type = ['init', 'insert']\n    parametric_insert_type = ['private', 'group', 'notice', 'request']\n    __slots__ = (\"insert_type\", \"to_run\",)\n\n    def __init__(self, _insert_type:str, _component_list:list):\n        self.insert_type = _insert_type\n        self.to_run = self.get_to_run(_component_list)\n        # to_run:list[function] for parametric_insert_type\n        # to_run:dict{'bot_qq':list[function]} for nonparametric_insert_type\n\n    def get_to_run(self, _component_list:list):\n        \"\"\"\n        Retuens:\n        ```\n            to_run:list[function]\n            to_run:dict{'bot_qq':list[function]}\n        ```\n        \"\"\"\n        if self.insert_type in self.nonparametric_insert_type:\n            return [_ for _ in _component_list if _.__alive__]\n        elif self.insert_type in self.parametric_insert_type:\n            to_run_dict:dict = {_:[] for _ in Config.cfginfo.keys()}\n            for _ in _component_list:\n                if [] == _.__dev__:\n                    to_run_dict = {\n                        v.append(_) or k:v for k,v in to_run_dict.items()\n                    }\n                else:\n                    for dev in _.__dev__:\n                        dev = str(dev)\n                        dev_to_list:list = to_run_dict.get(dev, [])\n                        dev_to_list.append(_)\n                        to_run_dict.update({dev:dev_to_list})\n            return to_run_dict\n\n    async def _run_core(self, _rev:dict = {}):\n        if self.insert_type in self.nonparametric_insert_type:\n            if [] != self.to_run:\n                await asyncio.gather(*[_() for _ in self.to_run])\n        elif self.insert_type in self.parametric_insert_type:\n            to_run_list:list = self.to_run.get(str(_rev.get(\"self_id\")), [])\n            to_run_list = [\n                _ for _ in to_run_list if (\n                    [] == _.__group__ or _rev.get('group_id') in _.__group__\n                )\n            ]\n            to_run_list = sorted(\n                to_run_list, key = lambda x:x.__num__, reverse = False\n            )\n            if [] != to_run_list:\n                await asyncio.gather(*[_(_rev) for _ in to_run_list])\n    def run(self, _rev:dict = {}): asyncio.run(self._run_core(_rev))", "\n\n\ndef run_rev_msg():\n    # ...\n    core_private_list:list = get_insert_plugins(\"private\")\n    core_group_list:list = get_insert_plugins(\"group\")\n    core_notice_list:list = get_insert_plugins(\"notice\")\n    core_request_list:list = get_insert_plugins(\"request\")\n    core_private = CoreOfInsert(\"private\", core_private_list)\n    core_group = CoreOfInsert(\"group\", core_group_list)\n    core_notice = CoreOfInsert(\"notice\", core_notice_list)\n    core_request = CoreOfInsert(\"request\", core_request_list)\n    # ...\n\n    # it should be execute once as follows:\n    core_private.run({'message':None})\n    core_group.run({'message':None})\n    # main loop: every rev should have a thread belonging to itself\n    while True:\n        rev = get_rev_msg()\n        if {} == rev: time.sleep(0.1); continue\n        if all((rev != {}, rev.get('post_type','meta_event') != 'meta_event')):\n            schedule.send_rev(rev)\n            post_type:str = rev['post_type'] if 'post_type' in rev else ''\n            msg_type:str = rev['message_type'] if 'message_type' in rev else ''\n            if msg_type == 'private' and all((\n                rev.get('user_id') not in Config(rev).blackqq_list,\n            )):\n                threading.Thread(target=core_private.run, args=(rev,)).start()\n            elif msg_type == 'group' and all((\n                rev.get('group_id') in Config(rev).group_list,\n                rev.get('user_id') not in Config(rev).blackqq_list,\n            )):\n                threading.Thread(target=core_group.run, args=(rev,)).start()\n            elif post_type == 'notice' and all((\n                any((\n                    rev.get('user_id') not in Config(rev).blackqq_list,\n                    rev.get('user_id',None) == None,\n                )),\n                any((\n                    rev.get('group_id') in Config(rev).group_list,\n                    rev.get('group_id',None) == None,\n                )),\n            )):\n                threading.Thread(target=core_notice.run, args=(rev,)).start()\n            elif post_type == 'request' and all((\n                any((\n                    rev.get('user_id') not in Config(rev).blackqq_list,\n                    rev.get('user_id',None) == None,\n                )),\n                any((\n                    rev.get('group_id') in Config(rev).group_list,\n                    rev.get('group_id',None) == None,\n                )),\n            )):\n                threading.Thread(target=core_request.run, args=(rev,)).start()", "\n\n\ndef _run(_yoshino:str, _max_thread:int):\n    assert isinstance(_yoshino, str)\n    assert isinstance(_max_thread, int)\n    load_all_config()\n    load_all_plugin()\n    is_cq_alive()\n    # ...\n    core_init_list:list = get_insert_plugins(\"init\")\n    coro_insert_list:list = get_insert_plugins(\"insert\")\n    core_init = CoreOfInsert(\"init\", core_init_list)\n    coro_insert = CoreOfInsert(\"insert\", coro_insert_list)\n    # ...\n    core_init.run()\n    with ThreadPoolExecutor(max_workers = _max_thread) as executor:\n        executor.submit(coro_insert.run)\n        executor.submit(run_receive_server)\n        executor.submit(run_rev_msg)\n        print(_yoshino)\n    print(\"~~~\u5c11\u5973\u7948\u7977\u4e2d~~~\")", "\n\ndef run(_yoshino:str = \"~~~ciallo~~~\", _max_thread:int = 3):\n    \"\"\"run yoshino bot\n    Args:\n    ```\n        _yoshino:str = \"~~~ciallo~~~\"\n    ```\n    Usages:\n    ```\n        if \"__main__\" == __name__:\n            fnbot.run()\n    ```\n    \"\"\"\n    return _run(_yoshino, _max_thread)", "\n\n"]}
{"filename": "fnbot/yoshinobot/__init__.py", "chunked_list": ["from .platforms import *\nfrom .bot_message import *\nfrom .bot_plugin import *\nfrom ._core import *\nfrom ._ciallo import *\n\n__all__ = ( platforms.__all__ +\n            bot_message.__all__ +\n            bot_plugin.__all__ +\n            _core.__all__ +", "            bot_plugin.__all__ +\n            _core.__all__ +\n            _ciallo.__all__\n)\n\nYOSHINO = \"YOSHINO\"\n"]}
{"filename": "fnbot/yoshinobot/_ciallo.py", "chunked_list": ["import re\nimport inspect\nimport asyncio\nfrom typing import overload\n\nfrom .platforms import Config\nfrom .platforms import Send\nfrom .platforms import Receive\nfrom .bot_message import Message\nfrom .msg_tools import *", "from .bot_message import Message\nfrom .msg_tools import *\n\n__all__ = \"ciallo\",\n\nclass ciallo:\n    \"\"\"\n    Args:\n    ```\n        _coro:coroutine\n        c:'Message' | dict | int | str | None = ...\n        r:'Message' | dict | int | str | None = ...\n        s:'Message' | dict | int | str | None = ...\n        m:dict |None = ...\n    ```\n    \"\"\"\n    pattern_function_list:list = []\n    \"\"\"`list['function']`\"\"\"\n    fullargspec_tuple_list:list = []\n    \"\"\"`list[tuple:'FullArgSpec']`\"\"\"\n\n    @overload\n    def __new__(self, _coro) -> 'schedule': ...\n    @overload\n    def __new__(self, c) -> 'Config': ...\n    @overload\n    def __new__(self, r) -> 'Receive': ...\n    @overload\n    def __new__(self, s) -> 'Send': ...\n    @overload\n    def __new__(self, m) -> 'Message': ...\n\n    def __new__(self, _coro = ..., c = ..., r = ..., s = ..., m = ...):\n        if ... != _coro and schedule._is_legal(_coro):\n            new_self_obj = schedule.__new__(schedule, _coro)\n            new_self_obj.__init__(_coro)\n            return new_self_obj\n        elif isinstance(c, (str, int, dict, Message, type(None))):\n            if None == c: return Config\n            new_self_obj = Config.__new__(Config, c)\n            new_self_obj.__init__(c)\n            return new_self_obj\n        elif isinstance(r, (str, int, dict, Message, type(None))):\n            if None == r: return Receive\n            new_self_obj = Receive.__new__(Receive, r)\n            new_self_obj.__init__(r)\n            return new_self_obj\n        elif isinstance(s, (str, int, dict, Message, type(None))):\n            if None == s: return Send\n            new_self_obj = Send.__new__(Send, s)\n            new_self_obj.__init__(s)\n            return new_self_obj\n        elif isinstance(m, (dict, type(None))):\n            if None == m: return Message\n            new_self_obj = Message.__new__(Message, m)\n            new_self_obj.__init__(m)\n            return new_self_obj\n        return ciallo\n\n\n    @overload\n    @classmethod\n    def grace(cls):...\n    @overload\n    @classmethod\n    def grace(cls, _nickname:str, /):...\n    @overload\n    @classmethod\n    def grace(cls, _nickname:str, _cmd:list, /):...\n\n    @classmethod\n    def grace(cls, _nickname = None, _cmd = None):\n        \"\"\"\n        Args:\n        ```\n            _nickname: str | None = None\n            _cmd: list | None = None\n        ```\n        \"\"\"\n        assert _nickname == None or isinstance(_nickname, str)\n        assert _cmd == None or isinstance(_cmd, list)\n        def _decorator(f):\n            assert getattr(f.__code__, 'co_argcount', None) in [0, 1, 3]\n            assert getattr(f.__code__, 'co_posonlyargcount', None) == 0\n            assert getattr(f.__code__, 'co_kwonlyargcount', None) == 0\n            if getattr(f.__code__, 'co_argcount', None) == 0:\n                async def decorator(): await f()\n            elif getattr(f.__code__, 'co_argcount', None) == 1:\n                async def decorator(rev:dict): _rev = Message(rev) ; await f(_rev)\n            elif getattr(f.__code__, 'co_argcount', None) == 3:\n                async def decorator(rev:dict):\n                    msg_type:str = 'group' if 'group_id' in rev else 'private'\n                    qq:str = str(rev['user_id']) if 'user_id' in rev else ''\n                    group_id = str(rev['group_id']) if 'group_id' in rev else ''\n                    num_type:str = qq if msg_type == 'private' else group_id\n                    _rev = Message(rev)\n                    await f(msg_type, num_type, _rev)\n            None != _nickname and setattr(decorator, '__nickname__', _nickname)\n            None != _cmd and setattr(decorator, '__cmd__', _cmd)\n            return decorator\n        return _decorator\n\n\n    @overload\n    @classmethod\n    def match(cls, _matched:str, _equal:list, /) -> bool:...\n    @overload\n    @classmethod\n    def match(cls, _matched:str, _equal:str, /) -> bool:...\n    @overload\n    @classmethod\n    def match(cls, _matched:str, *, _search:str) -> bool:...\n    @overload\n    @classmethod\n    def match(cls, _matched:str, *, _match:str) -> bool:...\n    @overload\n    @classmethod\n    def match(cls, _matched:str, *, _fullmatch:str) -> bool:...\n    @overload\n    @classmethod\n    def match(cls, _matched:str, _equal = None, /, *,\n        _search = None, _match = None, _fullmatch = None,\n    ) -> bool:...\n\n    @classmethod\n    def match(cls, _matched:str, _equal = None,\n        _search = None, _match = None, _fullmatch = None,\n    ) -> bool:\n        \"\"\"\n        Args:\n        ```\n            _matched:str\n            _equal:str | list | None\n            _search:str | None   :(re.search(_search, _matched))\n            _match:str | None   :(re.match(_match, _matched))\n            _fullmatch:str | None   :(re.fullmatch(_fullmatch, _matched))\n        ```\n        Returns:\n        ```\n            bool   :any((\n                _equal((_matched == _equal) or (_matched in _equal)),\n                re.search(_search, _matched),\n                re.match(_match, _matched),\n                re.fullmatch(_fullmatch, _matched)\n            ))\n        ```\n        \"\"\"\n        def _(_matched, __equal = _equal,\n            __search = _search, __match = _match, __fullmatch = _fullmatch,\n        ) -> bool:\n            if isinstance(__equal, str): __equal = (_matched == __equal)\n            if isinstance(__equal, list): __equal = (_matched in __equal)\n            if __search == None: __search = False\n            else: __search = re.search(__search, _matched)\n            if __match == None: __match = False\n            else: __match = re.match(__match, _matched)\n            if __fullmatch == None: __fullmatch = False\n            else: __fullmatch = re.fullmatch(__fullmatch, _matched)\n            return any((__equal, __search, __match, __fullmatch))\n        if inspect.getfullargspec(_) not in cls.fullargspec_tuple_list:\n            cls.pattern_function_list.append(_)\n            cls.fullargspec_tuple_list.append(inspect.getfullargspec(_))\n        try: assert isinstance(_matched, (str, int))\n        except AssertionError: return False\n\n        assert _equal == None or isinstance(_equal, (str, list))\n        assert _search == None or isinstance(_search, str)\n        assert _match == None or isinstance(_match, str)\n        assert _fullmatch == None or isinstance(_fullmatch, str)\n        if isinstance(_equal, str): _equal = (_matched == _equal)\n        if isinstance(_equal, list): _equal = (_matched in _equal)\n        if _search == None: _search = False\n        else: _search = re.search(_search, _matched)\n        if _match == None: _match = False\n        else: _match = re.match(_match, _matched)\n        if _fullmatch == None: _fullmatch = False\n        else: _fullmatch = re.fullmatch(_fullmatch, _matched)\n        return any((_equal, _search, _match, _fullmatch))\n\n\n    @classmethod\n    def compat_msg(cls, _msg:str, _msg_type:str, _rev) -> str:\n        \"\"\"\n        Make the messages to be sent compatible with\n        group chats and private chats\n\n        Args:\n        ```\n            _msg:str\n            _msg_type:str\n            _rev: dict | 'Message'\n        ```\n        \"\"\"\n        return compat_msg(_msg, _msg_type, _rev)\n\n\n    @overload\n    @classmethod\n    def forward_msg(cls, name:str, uin:int, msg_list:list, /) -> list:...\n    @overload\n    @classmethod\n    def forward_msg(cls, name:int, uin:str, msg_list:list, /) -> list:...\n    @overload\n    @classmethod\n    def forward_msg(cls, name:str, uin:str, msg_list:list, /) -> list:...\n    @overload\n    @classmethod\n    def forward_msg(cls, name:int, uin:int, msg_list:list, /) -> list:...\n\n    @classmethod\n    def forward_msg(cls, name, uin, msg_list:list) -> list:\n        \"\"\"\n        Args:\n        ```\n            name:str | int\n            uin:str | int\n            msg_list:list[str]\n        ```\n        \"\"\"\n        return forward_msg(name, uin, msg_list)\n\n\n    @classmethod\n    def is_group_admin(cls, _message:'Message') -> bool:\n        return is_group_admin(_message)\n\n\n    @classmethod\n    def is_bot_admin(cls, _message:'Message') -> bool:\n        return is_bot_admin(_message)\n\n\n    @classmethod\n    def get_current_path(cls, _file:str):\n        \"\"\"`_file` should be `__file__`\"\"\"\n        return get_current_path(_file)", "\n\n\nclass schedule:\n    scheduled_list:list = []\n    __slots__ = (\n        \"__awtstart__\", \"__awtwait__\", \"__awtdecline__\", \"__death__\",\n        \"timer\", \"counter\",\n        \"all_rev_list\", \"special_rev_list\", \"exc_rev_list\",\n        \"former_rev\",\n        \"self_id\", \"msg_type\", \"num_type\", \"user_id\", \"group_id\", \"msg_id\",\n    )\n    def __init__(self, _awtstart = ..., _awtwait = ..., _awtdecline = ...):\n        self.timer = 666\n        self.counter = 0\n        self.all_rev_list = []\n        self.special_rev_list = []\n        self.exc_rev_list = []\n        self.__death__ = self.__death_timer__\n        self.__awtwait__ = self.__forever__\n        self.__awtdecline__ = self.__forever__\n        if _awtstart != ...: self.__awtstart__ = _awtstart\n        if _awtwait != ...: self.__awtwait__ = _awtwait\n        if _awtdecline != ...: self.__awtdecline__ = _awtdecline\n    async def __forever__(): True and ... or False ; lambda:... ; return ; raise\n    __forever__ = staticmethod(__forever__)\n    async def __death_timer__(self): await asyncio.sleep(self.timer) ; raise RuntimeError\n    async def __run__(self):\n        self.scheduled_list.append(self)\n        if 0 == getattr(self.__awtstart__.__code__, 'co_argcount', None):\n            task_tuple = (asyncio.create_task(self.__awtstart__()), )\n        elif 1 == getattr(self.__awtstart__.__code__, 'co_argcount', None):\n            task_tuple = (asyncio.create_task(self.__awtstart__(self.former_rev)), )\n        else:\n            task_tuple = (\n                asyncio.create_task(self.__awtstart__(\n                    self.msg_type, self.num_type, self.former_rev\n                )),\n            )\n        if 0 == getattr(self.__awtwait__.__code__, 'co_argcount', None):\n            task_tuple += (asyncio.create_task(self.__awtwait__()), )\n        elif 1 == getattr(self.__awtwait__.__code__, 'co_argcount', None):\n            task_tuple += (asyncio.create_task(self.__awtwait__(self.former_rev)), )\n        else:\n            task_tuple += (\n                asyncio.create_task(self.__awtwait__(\n                    self.msg_type, self.num_type, self.former_rev\n                )),\n            )\n        if 0 == getattr(self.__awtdecline__.__code__, 'co_argcount', None):\n            task_tuple += (asyncio.create_task(self.__awtdecline__()), )\n        elif 1 == getattr(self.__awtdecline__.__code__, 'co_argcount', None):\n            task_tuple += (asyncio.create_task(self.__awtdecline__(self.former_rev)), )\n        else:\n            task_tuple += (\n                asyncio.create_task(self.__awtdecline__(\n                    self.msg_type, self.num_type, self.former_rev\n                )),\n            )\n        task_tuple += (asyncio.create_task(self.__death__()), )\n        try: await asyncio.wait(task_tuple, return_when = 'FIRST_EXCEPTION')\n        finally:\n            if self in self.scheduled_list: self.scheduled_list.remove(self)\n            del self\n    @classmethod\n    def _is_legal(cls, _coro = ...) -> bool:\n        return all((\n            getattr(_coro.__code__, \"co_flags\", None) in [147, 195],\n            getattr(_coro.__code__, 'co_argcount', None) in [0, 1, 3],\n            getattr(_coro.__code__, 'co_posonlyargcount', None) == 0,\n            getattr(_coro.__code__, 'co_kwonlyargcount', None) == 0,\n        ))\n    def awtstart(self, _coro = ...) -> 'schedule':\n        assert self._is_legal(_coro) ; self.__awtstart__ = _coro ; return self\n    def awtwait(self, _coro = ...) -> 'schedule':\n        assert self._is_legal(_coro) ; self.__awtwait__ = _coro ; return self\n    def awtdecline(self, _coro = ...) -> 'schedule':\n        assert self._is_legal(_coro) ; self.__awtdecline__ = _coro ; return self\n    async def start(self, _former_rev:'Message' = Message({})):\n        self.former_rev = _former_rev\n        self.self_id = _former_rev.self_id\n        self.msg_type = _former_rev.msg_type\n        self.num_type = _former_rev.num_type\n        self.user_id = _former_rev.user_id\n        self.group_id = _former_rev.group_id\n        self.msg_id = _former_rev.msg_id\n        await self.__run__()\n    async def cancel(self): raise RuntimeError\n    async def forever(self): self.__death__ = self.__forever__\n\n\n    @classmethod\n    def send_rev(cls, _rev:dict):\n        rev = Message(_rev)\n        _bool_list:list = [_(rev.msg) for _ in ciallo.pattern_function_list]\n        if cls.scheduled_list != []:\n            _:'schedule'\n            for _ in cls.scheduled_list:\n                if _bool_list.count(False) == len(_bool_list):\n                    if all((\n                        None != rev.msg, _.self_id == rev.self_id,\n                        _.user_id == rev.user_id, _.group_id == rev.group_id,\n                    )):\n                        _.special_rev_list.append(rev)\n                    elif all((\n                        None != rev.msg, _.self_id == rev.self_id,\n                        _.user_id != rev.user_id, _.group_id == rev.group_id,\n                    )):\n                        _.exc_rev_list.append(rev)\n                    if all((\n                        None != rev.msg, _.self_id == rev.self_id,\n                    )):\n                        _.all_rev_list.append(rev)\n\n    async def awt_all_rev(self) -> 'Message':\n        while True:\n            if self.all_rev_list != []:\n                return self.all_rev_list.pop(0)\n            await asyncio.sleep(0.1)\n\n    async def awt_special_rev(self) -> 'Message':\n        while True:\n            if self.special_rev_list != []:\n                return self.special_rev_list.pop(0)\n            await asyncio.sleep(0.1)\n\n    async def awt_exc_rev(self) -> 'Message':\n        while True:\n            if self.exc_rev_list != []:\n                return self.exc_rev_list.pop(0)\n            await asyncio.sleep(0.1)", "\n\n"]}
{"filename": "fnbot/yoshinobot/bot_message.py", "chunked_list": ["from typing import overload\n\nfrom .bot import BotMessage\n\nfrom .bot_insert import *\n\n__all__ = \"Message\",\n\n\n\nclass Message(BotMessage):\n    \"\"\"\n    Args:\n    ```\n        _rev:dict = {}\n    ```\n    \"\"\"\n    __slots__ = (\n        \"rev\",\n        \"time\", \"self_id\", \"post_type\",\n        \"message_type\", \"notice_type\", \"request_type\",\n\n        \"card_new\", \"card_old\", \"client\", \"comment\", \"duration\", \"file\",\n        \"flag\", \"font\", \"group_id\", \"honor_type\", \"message\", \"message_id\",\n        \"online\", \"operator_id\", \"raw_message\", \"sender_id\", \"sub_type\",\n        \"target_id\", \"user_id\", \"sender\",\n\n        \"sender_age\", \"sender_nickname\", \"sender_sex\", \"sender_user_id\",\n        \"sender_group_id\",\n        \"sender_area\", \"sender_card\", \"sender_level\", \"sender_role\",\n        \"sender_title\",\n    )\n    @overload\n    def __init__(self, _rev:dict, /): ...\n\n    def __init__(self, _rev:dict = {}):\n        if None == _rev: _rev = {}\n        assert isinstance(_rev, dict)\n        self.rev = _rev\n        self.time = _rev.get('time', None)\n        self.self_id = _rev.get('self_id', None)\n        self.post_type = _rev.get('post_type', None)\n\n        self.message_type = _rev.get('message_type', None)\n        self.notice_type = _rev.get('notice_type', None)\n        self.request_type = _rev.get('request_type', None)\n\n        self.card_new = _rev.get(\"card_new\", None)\n        self.card_old = _rev.get(\"card_old\", None)\n        self.client = _rev.get(\"client\", None)\n        self.comment = _rev.get(\"comment\", None)\n        self.duration = _rev.get(\"duration\", None)\n        self.file = _rev.get(\"file\", None)\n        self.flag = _rev.get(\"flag\", None)\n        self.font = _rev.get('font', None)\n        self.group_id = _rev.get('group_id', None)\n        self.honor_type = _rev.get(\"honor_type\", None)\n        self.message = _rev.get('message', None)\n        self.message_id = _rev.get('message_id', None)\n        self.online = _rev.get(\"online\", None)\n        self.operator_id = _rev.get(\"operator_id\", None)\n        self.raw_message = _rev.get(\"raw_message\", None)\n        self.sender_id = _rev.get(\"sender_id\", None)\n        self.sub_type = _rev.get('sub_type', None)\n        self.target_id = _rev.get(\"target_id\", None)\n        self.user_id = _rev.get('user_id', None)\n\n        self.sender:dict = _rev.get('sender', {})\n        # sender (in private or group)\n        self.sender_age = self.sender.get('age', None)\n        self.sender_nickname = self.sender.get('nickname', None)\n        self.sender_sex = self.sender.get('sex', None)\n        self.sender_user_id = self.sender.get('user_id', None)\n        # sender (only in group)\n        self.sender_area = self.sender.get('area', None)\n        self.sender_card = self.sender.get('card', None)\n        self.sender_level = self.sender.get('level', None)\n        self.sender_role = self.sender.get('role', None)\n        self.sender_title = self.sender.get('title', None)\n        # sender (only in temp)\n        self.sender_group_id = self.sender.get('group_id', None)\n\n    @property\n    def msg_type(self) -> str:\n        if self.group_id != None: return self.message_type\n        if self.group_id == None: return 'private'\n\n    @property\n    def num_type(self):\n        if self.group_id != None: return self.group_id\n        if self.group_id == None: return self.user_id\n\n    @property\n    def msg(self) -> str:\n        if self.message == None: return ''\n        else: return self.message\n    @msg.setter\n    def msg(self, _msg:str):\n        assert isinstance(_msg, str)\n        self.message = _msg\n\n    @property\n    def qq(self): return self.user_id\n\n    @property\n    def msg_id(self): return self.message_id\n\n\n\n    @overload\n    @classmethod\n    def insert_init(cls):...\n    @overload\n    @classmethod\n    def insert_init(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert_init(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert_init(cls,\n        _dev:list = [], _group:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert_init(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return InsertInit.manage(_dev, _group, _alive, _num)\n\n\n\n    @overload\n    @classmethod\n    def insert(cls):...\n    @overload\n    @classmethod\n    def insert(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert(cls,\n        _dev:list = [], _group:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return Insert.manage(_dev, _group, _alive, _num)\n\n\n\n    @overload\n    @classmethod\n    def insert_msg(cls):...\n    @overload\n    @classmethod\n    def insert_msg(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert_msg(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert_msg(cls,\n        _dev:list = [], _group:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert_msg(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return InsertMessage.manage(_dev, _group, _alive, _num)\n\n\n\n    @overload\n    @classmethod\n    def insert_private(cls):...\n    @overload\n    @classmethod\n    def insert_private(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert_private(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert_private(cls,\n        _dev:list = [], _group:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert_private(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return InsertPrivate.manage(_dev, _group, _alive, _num)\n\n\n\n    @overload\n    @classmethod\n    def insert_group(cls):...\n    @overload\n    @classmethod\n    def insert_group(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert_group(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert_group(cls,\n        _dev:list = [], _group:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert_group(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return InsertGroup.manage(_dev, _group, _alive, _num)\n\n\n\n    @overload\n    @classmethod\n    def insert_notice(cls):...\n    @overload\n    @classmethod\n    def insert_notice(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert_notice(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert_notice(cls,\n        _dev:list = [], _notice:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert_notice(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return InsertNotice.manage(_dev, _group, _alive, _num)\n\n\n\n    @overload\n    @classmethod\n    def insert_request(cls):...\n    @overload\n    @classmethod\n    def insert_request(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert_request(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert_request(cls,\n        _dev:list = [], _requinsert_request:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert_request(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return InsertRequest.manage(_dev, _group, _alive, _num)", "\n\nclass Message(BotMessage):\n    \"\"\"\n    Args:\n    ```\n        _rev:dict = {}\n    ```\n    \"\"\"\n    __slots__ = (\n        \"rev\",\n        \"time\", \"self_id\", \"post_type\",\n        \"message_type\", \"notice_type\", \"request_type\",\n\n        \"card_new\", \"card_old\", \"client\", \"comment\", \"duration\", \"file\",\n        \"flag\", \"font\", \"group_id\", \"honor_type\", \"message\", \"message_id\",\n        \"online\", \"operator_id\", \"raw_message\", \"sender_id\", \"sub_type\",\n        \"target_id\", \"user_id\", \"sender\",\n\n        \"sender_age\", \"sender_nickname\", \"sender_sex\", \"sender_user_id\",\n        \"sender_group_id\",\n        \"sender_area\", \"sender_card\", \"sender_level\", \"sender_role\",\n        \"sender_title\",\n    )\n    @overload\n    def __init__(self, _rev:dict, /): ...\n\n    def __init__(self, _rev:dict = {}):\n        if None == _rev: _rev = {}\n        assert isinstance(_rev, dict)\n        self.rev = _rev\n        self.time = _rev.get('time', None)\n        self.self_id = _rev.get('self_id', None)\n        self.post_type = _rev.get('post_type', None)\n\n        self.message_type = _rev.get('message_type', None)\n        self.notice_type = _rev.get('notice_type', None)\n        self.request_type = _rev.get('request_type', None)\n\n        self.card_new = _rev.get(\"card_new\", None)\n        self.card_old = _rev.get(\"card_old\", None)\n        self.client = _rev.get(\"client\", None)\n        self.comment = _rev.get(\"comment\", None)\n        self.duration = _rev.get(\"duration\", None)\n        self.file = _rev.get(\"file\", None)\n        self.flag = _rev.get(\"flag\", None)\n        self.font = _rev.get('font', None)\n        self.group_id = _rev.get('group_id', None)\n        self.honor_type = _rev.get(\"honor_type\", None)\n        self.message = _rev.get('message', None)\n        self.message_id = _rev.get('message_id', None)\n        self.online = _rev.get(\"online\", None)\n        self.operator_id = _rev.get(\"operator_id\", None)\n        self.raw_message = _rev.get(\"raw_message\", None)\n        self.sender_id = _rev.get(\"sender_id\", None)\n        self.sub_type = _rev.get('sub_type', None)\n        self.target_id = _rev.get(\"target_id\", None)\n        self.user_id = _rev.get('user_id', None)\n\n        self.sender:dict = _rev.get('sender', {})\n        # sender (in private or group)\n        self.sender_age = self.sender.get('age', None)\n        self.sender_nickname = self.sender.get('nickname', None)\n        self.sender_sex = self.sender.get('sex', None)\n        self.sender_user_id = self.sender.get('user_id', None)\n        # sender (only in group)\n        self.sender_area = self.sender.get('area', None)\n        self.sender_card = self.sender.get('card', None)\n        self.sender_level = self.sender.get('level', None)\n        self.sender_role = self.sender.get('role', None)\n        self.sender_title = self.sender.get('title', None)\n        # sender (only in temp)\n        self.sender_group_id = self.sender.get('group_id', None)\n\n    @property\n    def msg_type(self) -> str:\n        if self.group_id != None: return self.message_type\n        if self.group_id == None: return 'private'\n\n    @property\n    def num_type(self):\n        if self.group_id != None: return self.group_id\n        if self.group_id == None: return self.user_id\n\n    @property\n    def msg(self) -> str:\n        if self.message == None: return ''\n        else: return self.message\n    @msg.setter\n    def msg(self, _msg:str):\n        assert isinstance(_msg, str)\n        self.message = _msg\n\n    @property\n    def qq(self): return self.user_id\n\n    @property\n    def msg_id(self): return self.message_id\n\n\n\n    @overload\n    @classmethod\n    def insert_init(cls):...\n    @overload\n    @classmethod\n    def insert_init(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert_init(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert_init(cls,\n        _dev:list = [], _group:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert_init(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return InsertInit.manage(_dev, _group, _alive, _num)\n\n\n\n    @overload\n    @classmethod\n    def insert(cls):...\n    @overload\n    @classmethod\n    def insert(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert(cls,\n        _dev:list = [], _group:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return Insert.manage(_dev, _group, _alive, _num)\n\n\n\n    @overload\n    @classmethod\n    def insert_msg(cls):...\n    @overload\n    @classmethod\n    def insert_msg(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert_msg(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert_msg(cls,\n        _dev:list = [], _group:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert_msg(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return InsertMessage.manage(_dev, _group, _alive, _num)\n\n\n\n    @overload\n    @classmethod\n    def insert_private(cls):...\n    @overload\n    @classmethod\n    def insert_private(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert_private(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert_private(cls,\n        _dev:list = [], _group:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert_private(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return InsertPrivate.manage(_dev, _group, _alive, _num)\n\n\n\n    @overload\n    @classmethod\n    def insert_group(cls):...\n    @overload\n    @classmethod\n    def insert_group(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert_group(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert_group(cls,\n        _dev:list = [], _group:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert_group(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return InsertGroup.manage(_dev, _group, _alive, _num)\n\n\n\n    @overload\n    @classmethod\n    def insert_notice(cls):...\n    @overload\n    @classmethod\n    def insert_notice(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert_notice(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert_notice(cls,\n        _dev:list = [], _notice:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert_notice(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return InsertNotice.manage(_dev, _group, _alive, _num)\n\n\n\n    @overload\n    @classmethod\n    def insert_request(cls):...\n    @overload\n    @classmethod\n    def insert_request(cls, _dev:list, /):...\n    @overload\n    @classmethod\n    def insert_request(cls, *, _bool:bool):...\n    @overload\n    @classmethod\n    def insert_request(cls,\n        _dev:list = [], _requinsert_request:list = [], _bool:bool = True, _num:int = 0,\n    ):...\n\n    @classmethod\n    def insert_request(cls,\n        _dev:list = [], _group:list = [], _alive:bool = True, _num:int = 0,\n    ):\n        \"\"\"\n        Args:\n        ```\n            _dev:list[int | str] = []   :The device number you want to add\n            _group:list[int | str] = []   :The group number you want to add\n            _alive:bool = True   :Default execution\n            _num:int = 0   :the message triggering priority\n        ```\n        \"\"\"\n        return InsertRequest.manage(_dev, _group, _alive, _num)", "\n\n"]}
{"filename": "fnbot/yoshinobot/msg_tools.py", "chunked_list": ["import os\n\nfrom .platforms import Config\nfrom .platforms import Send\nfrom .bot_message import Message\n\n\n\ndef compat_msg(_msg:str, _msg_type:str, _rev) -> str:\n    assert isinstance(_msg, str)\n    assert isinstance(_msg_type, str)\n    assert isinstance(_rev, (Message, dict))\n    assert _msg_type in ['private', 'group']\n    if isinstance(_rev, Message): rev_dict:dict = _rev.rev\n    if isinstance(_rev, dict): rev_dict:dict = _rev\n    if _msg_type == \"private\":\n        if _msg.startswith(\"[CQ:at,qq=\"):\n            msg = _msg.split(\"]\",1)[-1]\n            msg = msg.lstrip(\"\\n\")\n            msg = \"@\" + rev_dict['sender']['nickname'] + \"\\n\" + msg\n            return msg\n        elif _msg.startswith(\"[CQ:reply,id=\"):\n            _, __, msg = _msg.split(\"]\", 2)\n            msg = msg.split(\"]\", 1)[-1]\n            msg = \"@\" + rev_dict['sender']['nickname'] + \"\\n\"+ msg\n            msg = _ + \"]\" + __ + \"]\" + msg\n            return msg\n    else:\n        return _msg", "def compat_msg(_msg:str, _msg_type:str, _rev) -> str:\n    assert isinstance(_msg, str)\n    assert isinstance(_msg_type, str)\n    assert isinstance(_rev, (Message, dict))\n    assert _msg_type in ['private', 'group']\n    if isinstance(_rev, Message): rev_dict:dict = _rev.rev\n    if isinstance(_rev, dict): rev_dict:dict = _rev\n    if _msg_type == \"private\":\n        if _msg.startswith(\"[CQ:at,qq=\"):\n            msg = _msg.split(\"]\",1)[-1]\n            msg = msg.lstrip(\"\\n\")\n            msg = \"@\" + rev_dict['sender']['nickname'] + \"\\n\" + msg\n            return msg\n        elif _msg.startswith(\"[CQ:reply,id=\"):\n            _, __, msg = _msg.split(\"]\", 2)\n            msg = msg.split(\"]\", 1)[-1]\n            msg = \"@\" + rev_dict['sender']['nickname'] + \"\\n\"+ msg\n            msg = _ + \"]\" + __ + \"]\" + msg\n            return msg\n    else:\n        return _msg", "\n\n\ndef forward_msg(name, uin, msg_list:list) -> list:\n    assert isinstance(name, (str, int))\n    assert isinstance(uin, (str, int))\n    assert isinstance(msg_list, list)\n    _forward_msg = []\n    for msg in msg_list:\n        _forward_msg.append({\n            \"type\": \"node\",\n            \"data\": {\n                \"name\": str(name),\n                \"uin\": str(uin),\n                \"content\": msg\n            }\n        })\n    else:\n        return _forward_msg", "\n\n\ndef is_group_admin(_message:'Message') -> bool:\n    assert isinstance(_message, Message)\n    self_id = _message.self_id\n    group_id = _message.group_id\n    user_id = _message.user_id\n    if self_id != None and group_id != None and user_id != None:\n        role = Send(self_id).get_group_member_info(group_id, user_id)\n    else: role = ''\n    if 'data' in role: role = role['data']\n    if 'role' in role: role = role['role']\n    if not isinstance(role, str): role = ''\n    return role in ['admin', 'owner']", "\n\n\ndef is_bot_admin(_message:'Message') -> bool:\n    self_id = _message.self_id\n    user_id = _message.user_id\n    return any((\n        self_id == user_id,\n        str(user_id) == str(Config(self_id).super_qq),\n        user_id in Config(self_id).admin_list,\n    ))", "\n\n\ndef get_current_path(_file:str):\n    _path = os.path.realpath(_file)\n    _path = _path.rstrip(os.path.basename(_file))\n    _path = eval(repr(_path).replace('\\\\\\\\','/'))\n    _path = str(_path).rstrip('\\\\\\\\').rstrip('/')\n    return _path"]}
{"filename": "fnbot/yoshinobot/bot/__init__.py", "chunked_list": ["\"\"\"\nyoshino bot\n\"\"\"\n\n__all__ = (\n    \"BotCiallo\",\n    \"BotConfig\", \"BotReceive\", \"BotSend\",\n    \"BotInsert\", \"BotMessage\", \"BotPlugin\",\n)\n", ")\n\n\n\nclass BotCiallo:\n    def __init__(self, self_id = ...):\n        \"\"\"\n        Args:\n        ```\n            self_id: 'BotMessage' | dict | int | str | None\n        ```\n        \"\"\"\n        assert isinstance(self_id, (\n            BotMessage, dict, int, str, type(None), type(Ellipsis),\n        ))\n        if isinstance(self_id, (str, int)):\n            self.self_id = str(self_id)\n        elif isinstance(self_id, dict):\n            self.self_id = str(self_id.get('self_id', None))\n        elif isinstance(self_id, (BotMessage,)):\n            self.self_id = str(getattr(self_id, 'self_id', None))\n        else:\n            self.self_id = None", "\nclass BotConfig(BotCiallo):\n    def __init__(self, _id = None):\n        super(BotConfig, self).__init__(_id)\nclass BotReceive(BotCiallo):\n    def __init__(self, _id = None):\n        super(BotReceive, self).__init__(_id)\nclass BotSend(BotCiallo):\n    def __init__(self, _id = None):\n        super(BotSend, self).__init__(_id)", "\nclass BotInsert(type):\n    def __new__(cls, _name:str, _bases:tuple, _dict:dict):\n        return type.__new__(cls, _name, _bases, _dict)\n    def __init__(self, _name:str, _bases:tuple, _dict:dict):\n        return type.__init__(self, _name, _bases, _dict)\nclass BotMessage:\n    def __init__(self):\n        super(BotMessage, self).__init__()\nclass BotPlugin:\n    def __init__(self):\n        super(BotPlugin, self).__init__()", "class BotPlugin:\n    def __init__(self):\n        super(BotPlugin, self).__init__()\n\n\n"]}
{"filename": "fnbot/yoshinobot/platforms/cq_config.py", "chunked_list": ["import os\nimport sys\nimport json\nfrom typing import overload\n\nimport toml\n\nfrom ..bot import BotConfig\n\n__all__ = ( \"Config\",", "\n__all__ = ( \"Config\",\n            \"load_config_toml\", \"load_config_json\",\n\n            \"load_all_config\", \"reload_config\",\n)\n\n\n\ndef setattr_of_cls(_objcls) -> 'Config':\n    if sys.path[0] != '': os.chdir(sys.path[0])\n    path_pybot:str = repr(os.getcwd()).replace('\\\\\\\\','/')\n    path_pybot:str = eval(path_pybot)\n    if path_pybot[1] == \":\":\n        disk_letter,disk_path = path_pybot.split(\":\",1)\n        path_pybot = disk_letter.upper() + \":\" + disk_path\n    setattr(_objcls, 'path_pybot', path_pybot)\n    setattr(_objcls, 'cfginfo', {})\n    setattr(_objcls, 'cfgfile', {})\n    return _objcls", "\ndef setattr_of_cls(_objcls) -> 'Config':\n    if sys.path[0] != '': os.chdir(sys.path[0])\n    path_pybot:str = repr(os.getcwd()).replace('\\\\\\\\','/')\n    path_pybot:str = eval(path_pybot)\n    if path_pybot[1] == \":\":\n        disk_letter,disk_path = path_pybot.split(\":\",1)\n        path_pybot = disk_letter.upper() + \":\" + disk_path\n    setattr(_objcls, 'path_pybot', path_pybot)\n    setattr(_objcls, 'cfginfo', {})\n    setattr(_objcls, 'cfgfile', {})\n    return _objcls", "\n@setattr_of_cls\nclass Config(BotConfig):\n    \"\"\"\n    Args:\n    ```\n        self_id: 'Message' | dict | int | str\n    ```\n    Class Properties:\n    ```\n        path_pybot: str\n        cfginfo: dict{\n            'bot_qq':dict,\n        }\n        cfgfile: dict{\n            'toml':['path'],\n            'json':['path'],\n        }\n    ```\n    \"\"\"\n    path_pybot: str\n    cfginfo: dict\n    \"\"\"\n    ```\n    dict{\n        'bot_qq':dict,\n    }\n    ```\n    \"\"\"\n    cfgfile: dict\n    \"\"\"\n    ```\n    dict{\n        'toml':['path'],\n        'json':['path'],\n    }\n    ```\n    \"\"\"\n    __slots__ = (\n        'self_id',\n        'host', 'port', 'post', 'bot_qq', 'group_list',\n        'nickname', 'super_qq', 'admin_list', 'blackqq_list',\n    )\n    @overload\n    def __init__(self, self_id, /): ...\n\n    def __init__(self, self_id = ...):\n        super().__init__(self_id)\n        self_cfginfo:dict = self.cfginfo.get(self.self_id, {})\n        self.host = self_cfginfo.get('host', None)\n        self.port = self_cfginfo.get('port', None)\n        self.post = self_cfginfo.get('post', None)\n        self.bot_qq = self_cfginfo.get('bot_qq', None)\n        self.nickname = self_cfginfo.get('nickname', None)\n        self.super_qq = self_cfginfo.get('super_qq', None)\n        self.admin_list:list = self_cfginfo.get('admin_list', None)\n        self.blackqq_list:list = self_cfginfo.get('blackqq_list', None)\n        self.group_list:list = self_cfginfo.get('group_list', None)", "\n\n\ndef _is_legal(_config_info:dict) -> bool:\n    if not isinstance(_config_info, dict): return False\n    return all((\n        'host' in _config_info,\n        type(_config_info.get('host')) == str,\n        'port' in _config_info,\n        type(_config_info.get('port')) == int,\n        'post' in _config_info,\n        type(_config_info.get('post')) == int,\n        'bot_qq' in _config_info,\n        type(_config_info.get('bot_qq')) == int,\n        'group_list' in _config_info,\n        type(_config_info.get('group_list')) == list,\n    ))", "\ndef _stdize_config_info(_config_info:dict) -> dict:\n    host:str = _config_info.get('host', \"127.0.0.1\")\n    port:int = _config_info.get('port', 9900)\n    post:int = _config_info.get('post', 9901)\n    bot_qq:int = _config_info.get('bot_qq', 0)\n    group_list:list = _config_info.get('group_list', [])\n    nickname:str = _config_info.get('nickname', \"\")\n    super_qq:int = _config_info.get('super_qq', 0)\n    admin_list:list = _config_info.get('admin_list', [])\n    blackqq_list:list = _config_info.get('blackqq_list', [])\n    return {\n        str(bot_qq):{\n            'host':host, 'port':port, 'post':post,\n            'bot_qq':bot_qq, 'group_list':group_list,\n            'nickname':nickname, 'super_qq':super_qq,\n            'admin_list':admin_list, 'blackqq_list':blackqq_list,\n        }\n    }", "\ndef _load_config(_config_info:dict):\n    config_info:dict = {}\n    if _is_legal(_config_info):\n        config_info.update(_stdize_config_info(_config_info))\n    else:\n        for v in _config_info.values():\n            if _is_legal(v): config_info.update(_stdize_config_info(v))\n    cfginfo = getattr(Config, \"cfginfo\", {})\n    cfginfo.update(config_info)\n    setattr(Config, \"cfginfo\", cfginfo)", "\ndef _to_right_path(_path:str) -> str:\n    if _path.startswith(\"./\"):\n        _path = _path.lstrip(\"./\").rstrip(\"/\")\n        _path = Config.path_pybot + '/' + _path\n    return _path\n\n\n\ndef load_config_toml(_path:str):\n    \"\"\"\n    Args:\n    ```\n        _path:str\n    ```\n    Usages:\n    ```\n        fnbot.load_config_toml(\"./pybot.toml\")\n    ```\n    \"\"\"\n    assert \".toml\" in _path\n    _path = _to_right_path(_path)\n    if os.path.isfile(_path):\n        cfgfile:dict = getattr(Config, \"cfgfile\", {})\n        config_file_toml:list = cfgfile.get(\"toml\", [])\n        config_file_toml.append(_path)\n        cfgfile.update({\"toml\":config_file_toml})\n        setattr(Config, \"cfgfile\", cfgfile)", "\ndef load_config_toml(_path:str):\n    \"\"\"\n    Args:\n    ```\n        _path:str\n    ```\n    Usages:\n    ```\n        fnbot.load_config_toml(\"./pybot.toml\")\n    ```\n    \"\"\"\n    assert \".toml\" in _path\n    _path = _to_right_path(_path)\n    if os.path.isfile(_path):\n        cfgfile:dict = getattr(Config, \"cfgfile\", {})\n        config_file_toml:list = cfgfile.get(\"toml\", [])\n        config_file_toml.append(_path)\n        cfgfile.update({\"toml\":config_file_toml})\n        setattr(Config, \"cfgfile\", cfgfile)", "\ndef load_config_json(_path:str):\n    \"\"\"\n    Args:\n    ```\n        _path:str\n    ```\n    Usages\n    ```\n        fnbot.load_config_json(\"./pybot.json\")\n    ```\n    \"\"\"\n    assert \".json\" in _path\n    _path = _to_right_path(_path)\n    if os.path.isfile(_path):\n        cfgfile:dict = getattr(Config, \"cfgfile\", {})\n        config_file_json:list = cfgfile.get(\"json\", [])\n        config_file_json.append(_path)\n        cfgfile.update({\"toml\":config_file_json})", "\ndef load_all_config():\n    cfgfile:dict = getattr(Config, \"cfgfile\", {})\n    config_file_toml:list = cfgfile.get(\"toml\", [])\n    config_file_json:list = cfgfile.get(\"json\", [])\n    for _ in config_file_toml:\n        with open(_, mode='r', encoding=\"utf-8\") as f:\n            config_toml:dict = toml.load(f)\n        _load_config(config_toml)\n    for _ in config_file_json:\n        with open(_, mode='r', encoding=\"utf-8\") as f:\n            config_json:dict = json.load(f)\n        _load_config(config_json)", "\ndef reload_config() -> bool:\n    if Config.cfginfo == {}: return False\n    Config.cfginfo.clear()\n    load_all_config()\n    return True\n\n\n", ""]}
{"filename": "fnbot/yoshinobot/platforms/__init__.py", "chunked_list": ["import time\n\nfrom .cq_config import *\nfrom .cq_receive import *\nfrom .cq_send import *\n\n__all__ = (\"is_cq_alive\",)\n\n__all__ += ( cq_config.__all__ +\n             cq_receive.__all__ +", "__all__ += ( cq_config.__all__ +\n             cq_receive.__all__ +\n             cq_send.__all__\n)\n\n\n\ndef is_cq_alive() -> bool:\n    for _ in list(Config.cfginfo.keys()):\n        try:\n            result = Send(_).get_status()\n            if not 'data' in result and result['data']['online']:\n                return is_cq_alive()\n        except:\n            time.sleep(1)\n            return is_cq_alive()\n    else:\n        return True"]}
{"filename": "fnbot/yoshinobot/platforms/cq_send.py", "chunked_list": ["from typing import overload\n\nimport requests\n\nfrom ..bot import BotSend\n\nfrom .cq_config import *\n\n__all__ = \"Send\",\n", "__all__ = \"Send\",\n\n\n\nclass Send(BotSend):\n    \"\"\"\n    Args:\n    ```\n        self_id: 'Message' | dict | int | str = ...\n        host:str = ...\n        port:int = ...\n    ```\n    \"\"\"\n    __slots__ = ('self_id', 'host', 'port',)\n\n    @overload\n    def __init__(self, self_id, /): ...\n    @overload\n    def __init__(self, *, host:str, port:int): ...\n\n    def __init__(self, self_id = ..., host = ..., port = ...):\n        super().__init__(self_id)\n        if isinstance(self_id, (type(None), type(Ellipsis))):\n            assert isinstance(host, str)\n            assert isinstance(port, int)\n            self.host = host\n            self.port = port\n        else:\n            self.host = Config(self_id).host\n            self.port = Config(self_id).port\n\n\n    def get_status(self) -> dict:\n        \"\"\"get_status\n\n        Returns:\n        ```\n        {\n            \"data\":{\n                \"app_enabled\":true,\n                \"app_good\":true,\n                \"app_initialized\":true,\n                \"good\":true,\n                \"online\":true,\n                \"plugins_good\":null,\n                \"stat\":{\n                    \"disconnect_times\":0,\n                    \"last_message_time\":0,\n                    \"lost_times\":0,\n                    \"message_received\":0,\n                    \"message_sent\":...,\n                    \"packet_lost\":0,\n                    \"packet_received\":...,\n                    \"packet_sent\":...\n                }\n            },\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n        \"\"\"\n        url = f\"http://{self.host}:{self.port}/get_status\"\n        rps = requests.post(url)\n        return rps.json()\n\n\n    def send_private_msg(self, user_id, message:str, group_id = None):\n        \"\"\"\n        Args:\n        ```\n            user_id:str | int\n            message:str\n            group_id:str | int | None\n        ```\n        Returns:\n        ```\n            msg_id:str | None\n        ```\n        \"\"\"\n        assert isinstance(user_id, (str, int))\n        assert isinstance(message, str)\n        url = f\"http://{self.host}:{self.port}/send_private_msg\"\n        if group_id != None:\n            assert isinstance(group_id, (str, int))\n            data = {\n                'user_id':int(user_id),\n                'group_id':int(group_id),\n                'message':message,\n            }\n            rps = requests.post(url,data)\n            if rps.json()[\"status\"] == \"ok\":\n                msg_id = rps.json()[\"data\"][\"message_id\"]\n            else:\n                msg_id = None\n            return msg_id\n        elif group_id == None:\n            data = {\n                'user_id':int(user_id),\n                'message':message,\n            }\n            rps = requests.post(url,data)\n            if rps.json()[\"status\"] == \"ok\":\n                msg_id = rps.json()[\"data\"][\"message_id\"]\n            else:\n                msg_id = None\n            return msg_id\n\n\n    def send_msg(self, msg_type:str, num_type, msg):\n        \"\"\"\n        Args:\n        ```\n            msg_type:str   :('private' or 'group')\n            num_type: str | int\n            msg: str | int\n        ```\n        Returns:\n        ```\n            msg_id:int | None\n        ```\n        \"\"\"\n        assert isinstance(msg_type, str)\n        assert msg_type in ['private', 'group']\n        assert isinstance(num_type, (str, int))\n        assert isinstance(msg, (str,int))\n        url = f\"http://{self.host}:{self.port}/send_msg\"\n        if msg_type == \"private\":\n            data = {\n                'message_type':msg_type,\n                'user_id':int(num_type),\n                'message':msg,\n            }\n            rps = requests.post(url,data)\n            if rps.json()[\"status\"] == \"ok\":\n                msg_id = rps.json()[\"data\"][\"message_id\"]\n            else:\n                msg_id = None\n            return msg_id\n        elif msg_type == \"group\":\n            data = {\n                'message_type':msg_type,\n                'group_id':int(num_type),\n                'message':msg,\n            }\n            rps = requests.post(url,data)\n            if rps.json()[\"status\"] == \"ok\":\n                msg_id = rps.json()[\"data\"][\"message_id\"]\n            else:\n                msg_id = None\n            return msg_id\n\n\n    def send_forward_msg(self, msg_type:str, num_type, msg:list):\n        \"\"\"\n        Args:\n        ```\n            msg_type:str   :('private' or 'group')\n            num_type:str | int\n            msg:list\n        ```\n        Returns:\n        ```\n            msg_id:int | None\n        \"\"\"\n        assert isinstance(msg_type, str)\n        assert msg_type in ['private', 'group']\n        assert isinstance(num_type, (str, int))\n        assert isinstance(msg, list)\n        if msg_type == 'group':\n            return self.send_group_forward_msg(num_type, msg)\n        else: return self.send_private_forward_msg(num_type, msg)\n\n\n    def send_private_forward_msg(self, user_id, messages:list):\n        \"\"\"\n        Args:\n        ```\n            user_id:str | int\n            messages:list\n        ```\n        Returns:\n        ```\n            msg_id:int | None\n        ```\n        \"\"\"\n        assert isinstance(user_id, (str, int))\n        assert isinstance(messages, list)\n        data = {\n            'user_id':int(user_id),\n            'messages':messages,\n        }\n        url = f\"http://{self.host}:{self.port}/send_private_forward_msg\"\n        rps = requests.post(url,json=data)\n        if rps.json()[\"status\"] == \"ok\":\n            msg_id = rps.json()[\"data\"][\"message_id\"]\n        else:\n            msg_id = None\n        return msg_id\n\n\n    def send_group_forward_msg(self, group_id, messages:list):\n        \"\"\"\n        Args:\n        ```\n            group_id:str | int\n            messages:list\n        ```\n        Returns:\n        ```\n            msg_id:int | None\n        ```\n        \"\"\"\n        assert isinstance(group_id, (str, int))\n        assert isinstance(messages, list)\n        data = {\n            'group_id':int(group_id),\n            'messages':messages,\n        }\n        url = f\"http://{self.host}:{self.port}/send_group_forward_msg\"\n        rps = requests.post(url,json=data)\n        if rps.json()[\"status\"] == \"ok\":\n            msg_id = rps.json()[\"data\"][\"message_id\"]\n        else:\n            msg_id = None\n        return msg_id\n\n\n    def delete_msg(self, message_id) -> dict:\n        \"\"\"\n        Args:\n        ```\n            message_id:int | str\n        ```\n        Returns:\n        ```\n        {\n            \"data\":null,\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        or\n        {\n            \"data\":null,\n            \"msg\":\"MESSAGE_NOT_FOUND\",\n            \"retcode\":100,\n            \"status\":\"failed\",\n            \"wording\":\"\u6d88\u606f\u4e0d\u5b58\u5728\"\n        }\n        \"\"\"\n        assert isinstance(message_id, (str, int))\n        data = {\n            'message_id':int(message_id)\n        }\n        url = f\"http://{self.host}:{self.port}/delete_msg\"\n        rps = requests.post(url,data)\n        return rps.json()\n\n\n    def get_msg(self, message_id) -> dict:\n        \"\"\"\n        Args:\n        ```\n            message_id:str | int\n        ```\n        Returns:\n        ```\n        {\n            \"data\":{\n                \"group\":true,\n                \"group_id\":...,\n                \"message\":\"...\",\n                \"message_id\":...,\n                \"message_id_v2\":\"...\",\n                \"message_seq\":...,\n                \"message_type\":\"group\",\n                \"real_id\":...,\n                \"sender\":{\n                    \"nickname\":\"...\",\n                    \"user_id\":...\n                },\n                \"time\":...\n            },\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        or\n        {\n            \"data\":{\n                \"group\":false,\n                \"message\":\"...\",\n                \"message_id\":...,\n                \"message_id_v2\":\"...\",\n                \"message_seq\":...,\n                \"message_type\":\"private\",\n                \"real_id\":...,\n                \"sender\":{\n                    \"nickname\":\"...\",\n                    \"user_id\":...\n                },\n                \"time\":...\n            },\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n        \"\"\"\n        assert isinstance(message_id, (str, int))\n        data = {\n            'message_id':int(message_id)\n        }\n        url = f\"http://{self.host}:{self.port}/get_msg\"\n        rps = requests.post(url,data)\n        return rps.json()\n\n\n    def set_group_kick(self,\n        group_id, user_id, reject_add_request:bool = False\n    ) -> dict:\n        \"\"\"\n        Args:\n        ```\n            group_id:str | int\n            user_id:str | int\n            reject_add_request:bool\n        ```\n        Returns:\n        ```\n        {\n            \"data\":null,\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n        \"\"\"\n        assert isinstance(user_id, (str, int))\n        assert isinstance(group_id, (str, int))\n        assert isinstance(reject_add_request, bool)\n        data = {\n            'group_id':int(group_id),\n            'user_id':int(user_id),\n            'reject_add_request':reject_add_request,\n        }\n        url = f\"http://{self.host}:{self.port}/set_group_kick\"\n        rps = requests.post(url,json=data)\n        return rps.json()\n\n\n    def set_group_ban(self, group_id, user_id, duration:int = 60) -> dict:\n        \"\"\"\n        Args:\n        ```\n            group_id:str | int\n            user_id:str | int\n            duration:int\n        ```\n        Returns:\n        ```\n        {\n            \"data\":null,\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n        \"\"\"\n        assert isinstance(user_id, (str, int))\n        assert isinstance(group_id, (str, int))\n        assert isinstance(duration, int)\n        data = {\n            'group_id':int(group_id),\n            'user_id':int(user_id),\n            'duration':str(duration),\n        }\n        url = f\"http://{self.host}:{self.port}/set_group_ban\"\n        rps = requests.post(url,data)\n        return rps.json()\n\n\n    def set_group_card(self, group_id, user_id, card:str) -> dict:\n        \"\"\"\n        Args:\n        ```\n            group_id:str | int\n            user_id:str | int\n            card:str\n        ```\n        Returns:\n        ```\n        {\n            \"data\":null,\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n        \"\"\"\n        assert isinstance(group_id, (str, int))\n        assert isinstance(user_id, (str, int))\n        assert isinstance(card, str)\n        data = {\n            'group_id':int(group_id),\n            'user_id':int(user_id),\n            'card':card,\n        }\n        url = f\"http://{self.host}:{self.port}/set_group_card\"\n        rps = requests.post(url,data)\n        return rps.json()\n\n\n    def set_group_leave(self, group_id, is_dismiss:bool = False) -> dict:\n        \"\"\"\n        Args:\n        ```\n            group_id:str | int\n            is_dismiss:bool\n        ```\n        Returns:\n        ```\n        {\n            \"data\":null,\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n        \"\"\"\n        assert isinstance(group_id, (str, int))\n        assert isinstance(is_dismiss, bool)\n        data = {\n            'group_id':int(group_id),\n            'is_dismiss':is_dismiss,\n        }\n        url = f\"http://{self.host}:{self.port}/set_group_leave\"\n        rps = requests.post(url,data)\n        return rps.json()\n\n\n    def get_stranger_info(self, user_id) -> dict:\n        \"\"\"\n        Args:\n        ```\n            user_id:str | int\n        ```\n        Returns:\n        ```\n        {\n            \"data\":{\n                \"age\":...,\n                \"level\":...,\n                \"login_days\":...,\n                \"nickname\":\"...\",\n                \"qid\":\"...\",\n                \"sex\":\"...\",\n                \"user_id\":...\n            },\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n        \"\"\"\n        assert isinstance(user_id, (str, int))\n        data = {\n            'user_id':int(user_id),\n        }\n        url = f\"http://{self.host}:{self.port}/get_stranger_info\"\n        rps = requests.post(url,data)\n        return rps.json()\n\n\n    def get_friend_list(self) -> dict:\n        \"\"\"\n        Returns:\n        ```\n        {\n            \"data\":[\n                {\n                    \"nickname\":\"babyQ\",\n                    \"remark\":\"babyQ\",\n                    \"user_id\":66600000\n                },\n                ...\n            ],\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n        \"\"\"\n        url = f\"http://{self.host}:{self.port}/get_friend_list\"\n        rps = requests.post(url)\n        return rps.json()\n\n\n    def delete_friend(self, friend_id) -> dict:\n        \"\"\"?\n        Args:\n        ```\n            friend_id:str | int\n        ```\n        Returns:\n        ```\n        {\n            \"data\":null,\n            \"msg\":\"FRIEND_NOT_FOUND\",\n            \"retcode\":100,\n            \"status\":\"failed\",\n            \"wording\":\"\u597d\u53cb\u4e0d\u5b58\u5728\"\n        }\n        ```\n        \"\"\"\n        assert isinstance(friend_id, (str, int))\n        data = {\n            'friend_id':int(friend_id),\n        }\n        url = f\"http://{self.host}:{self.port}/delete_friend\"\n        rps = requests.post(url,json=data)\n        return rps.json()\n\n\n    def get_group_info(self, group_id) -> dict:\n        \"\"\"\n        Args:\n        ```\n            group_id:str | int\n        ```\n        Returns:\n        ```\n        {\n            \"data\":{\n                \"group_create_time\":0,\n                \"group_id\":...,\n                \"group_level\":0,\n                \"group_name\":\"...\",\n                \"max_member_count\":...,\n                \"member_count\":...\n            },\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n\n        Others:\n            `https://p.qlogo.cn/gh/{group_id}/{group_id}/100`\n        \"\"\"\n        assert isinstance(group_id, (str, int))\n        data = {\n            'group_id':int(group_id),\n        }\n        url = f\"http://{self.host}:{self.port}/get_group_info\"\n        rps = requests.post(url,data)\n        return rps.json()\n\n\n    def get_group_list(self) -> dict:\n        \"\"\"\n        Returns:\n        ```\n        {\n            \"data\":[\n                {\n                    \"group_create_time\":0,\n                    \"group_id\":...,\n                    \"group_level\":0,\n                    \"group_name\":\"...\",\n                    \"max_member_count\":200,\n                    \"member_count\":...\n                },\n                ...\n            ],\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n        \"\"\"\n        url = f\"http://{self.host}:{self.port}/get_group_list\"\n        rps = requests.post(url)\n        return rps.json()\n\n\n    def get_group_member_info(self, group_id, user_id) -> dict:\n        \"\"\"\n        Args:\n        ```\n            group_id:str | int\n            user_id:str | int\n        ```\n        Returns:\n        ```\n        {\n            \"data\":{\n                \"age\":0,\n                \"area\":\"\",\n                \"card\":\"\",\n                \"card_changeable\":false,\n                \"group_id\":...,\n                \"join_time\":...,\n                \"last_sent_time\":...,\n                \"level\":\"...\",\n                \"nickname\":\"...\",\n                \"role\":\"...\",\n                \"sex\":\"...\",\n                \"shut_up_timestamp\":0,\n                \"title\":\"\",\n                \"title_expire_time\":0,\n                \"unfriendly\":false,\n                \"user_id\":...\n            },\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n        \"\"\"\n        assert isinstance(user_id, (str, int))\n        assert isinstance(group_id, (str, int))\n        data = {\n            'group_id':int(group_id),\n            'user_id':int(user_id),\n        }\n        url = f\"http://{self.host}:{self.port}/get_group_member_info\"\n        rps = requests.post(url,data)\n        return rps.json()\n\n\n    def get_group_member_list(self, group_id) -> dict:\n        \"\"\"\n        Args:\n        ```\n            group_id:str | int\n        ```\n        Returns:\n        ```\n        {\n            \"data\":[\n                {\n                    \"age\":0,\n                    \"area\":\"\",\n                    \"card\":\"\",\n                    \"card_changeable\":false,\n                    \"group_id\":...,\n                    \"join_time\":...,\n                    \"last_sent_time\":...,\n                    \"level\":\"...\",\n                    \"nickname\":\"...\",\n                    \"role\":\"...\",\n                    \"sex\":\"...\",\n                    \"shut_up_timestamp\":0,\n                    \"title\":\"\",\n                    \"title_expire_time\":0,\n                    \"unfriendly\":false,\n                    \"user_id\":...\n                },...\n            ],\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n        \"\"\"\n        assert isinstance(group_id, (str, int))\n        data = {\n            'group_id':int(group_id),\n        }\n        url = f\"http://{self.host}:{self.port}/get_group_member_list\"\n        rps = requests.post(url,data)\n        return rps.json()\n\n\n    def set_friend_add_request(self,\n        flag:str, approve:bool, remark:str = '',\n    ) -> dict:\n        \"\"\"\n        Args:\n        ```\n            flag:str\n            approve:bool\n            remark:str\n        ```\n        Returns:\n        ```\n        {'data': None, 'retcode': 0, 'status': 'ok'}\n        ```\n        \"\"\"\n        assert isinstance(flag, str)\n        assert isinstance(approve, bool)\n        assert isinstance(remark, str)\n        data = {\n            'flag':flag,\n            'approve':approve,\n            'remark':remark,\n        }\n        url = f\"http://{self.host}:{self.port}/set_friend_add_request\"\n        rps = requests.post(url,json=data)\n        return rps.json()\n\n\n    def set_group_add_request(self,\n        flag:str, sub_type:str, approve:bool, reason = None,\n    ) -> dict:\n        \"\"\"\n        Args:\n        ```\n            flag:str\n            sub_type:str   :('add' or 'invite')\n            approve:bool\n            reason:str | bool\n        ```\n        Returns:\n        ```\n        {'data': None, 'retcode': 0, 'status': 'ok'}\n        ```\n        \"\"\"\n        assert isinstance(flag, str)\n        assert isinstance(sub_type, str)\n        assert isinstance(approve, bool)\n        assert sub_type in ['add', 'invite']\n        data = {\n            'flag':flag,\n            'sub_type':sub_type,\n            'approve':approve,\n            'reason':reason,\n        }\n        url = f\"http://{self.host}:{self.port}/set_group_add_request\"\n        rps = requests.post(url,json=data)\n        return rps.json()\n\n\n    def send_group_sign(self, group_id) -> dict:\n        \"\"\"\n        Args:\n        ```\n            group_id:str | int\n        ```\n        Returns:\n        ```\n        {\n            \"data\":null,\n            \"retcode\":0,\n            \"status\":\"ok\"\n        }\n        ```\n        \"\"\"\n        assert isinstance(group_id, (str, int))\n        data = {\n            'group_id':int(group_id),\n        }\n        url = f\"http://{self.host}:{self.port}/send_group_sign\"\n        rps = requests.post(url,data)\n        return rps.json()", "\n\n"]}
{"filename": "fnbot/yoshinobot/platforms/cq_receive.py", "chunked_list": ["import json\nimport socket\nimport threading\nfrom typing import overload\n\nfrom ..bot import BotReceive\n\nfrom .cq_config import Config\n\n__all__ = ( \"Receive\",", "\n__all__ = ( \"Receive\",\n\n            \"get_rev_msg\", \"run_receive_server\",\n)\n\n\n\nclass Receive(BotReceive):\n    \"\"\"\n    Args:\n    ```\n        self_id: 'Message' | dict | int | str = ...\n        host:str = ...\n        post:int = ...\n    ```\n    Class Properties:\n    ```\n        dev_list: list[self@Receive]\n        rev_list: list[dict]\n    ```\n    \"\"\"\n    dev_list:list = []\n    \"\"\"`list[self@Receive]`\"\"\"\n    rev_list:list = []\n    \"\"\"`list[dict]`\"\"\"\n    __slots__ = ('self_id', 'host', 'post',)\n\n    @overload\n    def __init__(self, self_id, /): ...\n    @overload\n    def __init__(self, *, host:str, post:int): ...\n\n    def __init__(self, self_id = ..., host = ..., post = ...):\n        super().__init__(self_id)\n        self.dev_list.append(self)\n        if isinstance(self_id, (type(None), type(Ellipsis))):\n            assert isinstance(host, str)\n            assert isinstance(post, int)\n            self.host = host\n            self.post = post\n        else:\n            self.host = Config(self_id).host\n            self.post = Config(self_id).post\n\n\n    def __call__(self):\n        botsocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        header = 'HTTP/1.1 200 OK\\n\\n'\n        self._bind(botsocket)\n        while True:\n            try:\n                self._launch(header, botsocket)\n            except: ...\n\n    @classmethod\n    def _to_json(cls, msg):\n        for i in range(len(msg)):\n            if msg[i] == \"{\" and msg[-1] == \"\\n\":\n                return json.loads(msg[i:])\n        return\n\n    def _bind(self, _botsocket):\n        try:\n            _botsocket.bind((self.host, self.post))\n            _botsocket.listen(100)\n        except:\n            self._bind(_botsocket)\n\n    def _launch(self, _header, _botsocket):\n        conn = _botsocket.accept()[0]\n        with conn:\n            data = conn.recv(16384).decode(encoding='utf-8')\n            conn.sendall((_header).encode(encoding='utf-8'))\n            rev_dict = self._to_json(data)\n        if rev_dict != None: self.rev_list.append(rev_dict)", "class Receive(BotReceive):\n    \"\"\"\n    Args:\n    ```\n        self_id: 'Message' | dict | int | str = ...\n        host:str = ...\n        post:int = ...\n    ```\n    Class Properties:\n    ```\n        dev_list: list[self@Receive]\n        rev_list: list[dict]\n    ```\n    \"\"\"\n    dev_list:list = []\n    \"\"\"`list[self@Receive]`\"\"\"\n    rev_list:list = []\n    \"\"\"`list[dict]`\"\"\"\n    __slots__ = ('self_id', 'host', 'post',)\n\n    @overload\n    def __init__(self, self_id, /): ...\n    @overload\n    def __init__(self, *, host:str, post:int): ...\n\n    def __init__(self, self_id = ..., host = ..., post = ...):\n        super().__init__(self_id)\n        self.dev_list.append(self)\n        if isinstance(self_id, (type(None), type(Ellipsis))):\n            assert isinstance(host, str)\n            assert isinstance(post, int)\n            self.host = host\n            self.post = post\n        else:\n            self.host = Config(self_id).host\n            self.post = Config(self_id).post\n\n\n    def __call__(self):\n        botsocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        header = 'HTTP/1.1 200 OK\\n\\n'\n        self._bind(botsocket)\n        while True:\n            try:\n                self._launch(header, botsocket)\n            except: ...\n\n    @classmethod\n    def _to_json(cls, msg):\n        for i in range(len(msg)):\n            if msg[i] == \"{\" and msg[-1] == \"\\n\":\n                return json.loads(msg[i:])\n        return\n\n    def _bind(self, _botsocket):\n        try:\n            _botsocket.bind((self.host, self.post))\n            _botsocket.listen(100)\n        except:\n            self._bind(_botsocket)\n\n    def _launch(self, _header, _botsocket):\n        conn = _botsocket.accept()[0]\n        with conn:\n            data = conn.recv(16384).decode(encoding='utf-8')\n            conn.sendall((_header).encode(encoding='utf-8'))\n            rev_dict = self._to_json(data)\n        if rev_dict != None: self.rev_list.append(rev_dict)", "\n\n\ndef get_rev_msg() -> dict:\n    if Receive.rev_list != []: return Receive.rev_list.pop(0)\n    else: return {}\n\n\ndef run_receive_server():\n    for _ in Config.cfginfo: Receive(_)\n    for _ in Receive.dev_list:\n        threading.Thread(target=_).start()", "def run_receive_server():\n    for _ in Config.cfginfo: Receive(_)\n    for _ in Receive.dev_list:\n        threading.Thread(target=_).start()\n"]}
