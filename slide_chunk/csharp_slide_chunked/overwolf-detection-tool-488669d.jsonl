{"filename": "src/DetectionTool.Console/Program.cs", "chunked_list": ["\ufeffusing DetectionTool.Core;\n\nRunScan();\n\nstatic void RunScan() {\n  var scanner = new Scanner();\n\n  try {\n    var results = scanner.Scan();\n\n    if (results.Detected) {\n      Console.ForegroundColor = ConsoleColor.Red;\n      Console.WriteLine(\"Detected: YES\");\n      Console.WriteLine(\"Possible Malware traces were detected on your machine\");\n      Console.WriteLine();\n      Console.WriteLine(\"Suspicious Files:\");", "    if (results.Detected) {\n      Console.ForegroundColor = ConsoleColor.Red;\n      Console.WriteLine(\"Detected: YES\");\n      Console.WriteLine(\"Possible Malware traces were detected on your machine\");\n      Console.WriteLine();\n      Console.WriteLine(\"Suspicious Files:\");\n      foreach(var detectedFile in results.DetectedFiles) {\n        Console.WriteLine($\"  => {detectedFile}\");\n      }\n      Console.WriteLine();\n      Console.ForegroundColor = ConsoleColor.Blue;\n      Console.WriteLine($\"For instructions on what to do next go to: {DetectionTool.Core.Constants.kSupportArticle}\");\n\n    } else {\n      Console.ForegroundColor = ConsoleColor.Green;\n      Console.WriteLine(\"Detected: NO\");\n      Console.WriteLine(\"Malware was not detected on your machine\");\n    }", "  } catch (Exception ex) {\n    Console.ForegroundColor = ConsoleColor.Yellow;\n    Console.WriteLine(\"Detected: Inconclusive\");\n    Console.WriteLine($\"Scan failed. {ex.Message}\");\n  }\n\n  Console.ResetColor();\n}"]}
{"filename": "src/DetectionTool.Core/Scanner.cs", "chunked_list": ["\ufeffusing System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.Linq;\nusing System.Text;\n\nnamespace DetectionTool.Core {\n  internal class Scanner {\n    private string[] _suspiciousFilesWindows = new string[] {\n      \".ref\",\n      \"client.jar\",\n      \"lib.dll\",\n      \"libWebGL64.jar\",\n      \"run.bat\"\n    };\n    private string[] _suspiciousFilesLinux = new string[] {\n      \".ref\",\n      \"client.jar\",\n      \"lib.dll\",\n    };\n\n    const string kPath = \"Microsoft Edge\";\n    const string kStartupPath = \"Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\";\n", "    private readonly string _linuxMalwarePath = Path.Combine(\n      Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),\n      \".data\");\n    \n    private readonly string _windowsMalwarePath;\n    private readonly string _malwareStartupFilePath;\n\n    public Scanner() {\n      _windowsMalwarePath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData), kPath);\n      _malwareStartupFilePath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData), kStartupPath, \"run.bat\");\n    }\n", "    public IScanResults Scan() {\n      var scanResults = new ScanResults();\n\n      var detectedFiles = Environment.OSVersion.Platform == PlatformID.Win32NT\n        ? CheckFiles(_windowsMalwarePath, _suspiciousFilesWindows)\n        : CheckFiles(_linuxMalwarePath, _suspiciousFilesLinux);\n\n      scanResults.DetectedFiles = detectedFiles;\n      if (detectedFiles.Any()) {\n        scanResults.FoundInPath = true;\n      }\n\n      // Check startup path only on windows platform", "      if (detectedFiles.Any()) {\n        scanResults.FoundInPath = true;\n      }\n\n      // Check startup path only on windows platform\n      if (Environment.OSVersion.Platform == PlatformID.Win32NT) {\n        scanResults.FoundInStartUp = CheckStartup();\n\n        if (scanResults.FoundInStartUp) {\n          scanResults.DetectedFiles = scanResults.DetectedFiles.Concat(new string[] { _malwareStartupFilePath });\n        }\n      }\n      return scanResults;\n    }\n\n    private IEnumerable<string> CheckFiles(string path, IEnumerable<string> files) {\n      var detectedFiles = new List<string>();\n", "        if (scanResults.FoundInStartUp) {\n          scanResults.DetectedFiles = scanResults.DetectedFiles.Concat(new string[] { _malwareStartupFilePath });\n        }\n      }\n      return scanResults;\n    }\n\n    private IEnumerable<string> CheckFiles(string path, IEnumerable<string> files) {\n      var detectedFiles = new List<string>();\n\n      if (!Directory.Exists(path)) {\n        return detectedFiles;\n      }\n", "      if (!Directory.Exists(path)) {\n        return detectedFiles;\n      }\n\n      foreach (var fileName in files) {\n        var fileFullPath = Path.Combine(path, fileName);\n\n        if (File.Exists(fileFullPath)) {\n          detectedFiles.Add(fileFullPath);\n        }\n      }\n\n      return detectedFiles;\n    }\n", "    private bool CheckStartup() {\n      if (!File.Exists(_malwareStartupFilePath)) {\n        return false;\n      }\n\n      return true;\n    }\n  }\n}"]}
{"filename": "src/DetectionTool.Core/ScanResults.cs", "chunked_list": ["\ufeffusing System.Collections.Generic;\n\nnamespace DetectionTool.Core {\n  internal interface IScanResults {\n    bool Detected { get; }\n    bool FoundInPath { get; }\n    bool FoundInStartUp { get; }\n\n    IEnumerable<string> DetectedFiles { get; }\n  }\n", "  internal class ScanResults : IScanResults {\n    public bool Detected => FoundInPath || FoundInStartUp;\n    public bool FoundInPath { get; set; }\n    public bool FoundInStartUp { get; set; }\n\n    public IEnumerable<string> DetectedFiles { get; set; }\n  }\n}\n"]}
{"filename": "src/DetectionTool.Core/Constants.cs", "chunked_list": ["\ufeffusing System;\n\nnamespace DetectionTool.Core {\n  public static class Constants {\n    public const string kSupportArticle = \"https://support.curseforge.com/en/support/solutions/articles/9000228509-june-2023-infected-mods-detection-tool\";\n\n  }\n}\n"]}
{"filename": "src/DetectionTool.Linux/MainWindow.cs", "chunked_list": ["using Gtk;\nusing System.Diagnostics;\nusing DetectionTool.Core;\n\nnamespace DetectionToolLinux {\n  public partial class MainWindow : Window {\n    private readonly Button _buttonScan;\n    private readonly Label _labelSummaryValue;\n    private readonly Label _labelDetectedResult;\n    private readonly Label _labelFoundInStartupValue;\n    private readonly Label _labelSuspiciousFiles;", "    private readonly Label _labelDetectedResult;\n    private readonly Label _labelFoundInStartupValue;\n    private readonly Label _labelSuspiciousFiles;\n    private readonly TextView _textBoxSuspiciousFiles;\n    private readonly LinkButton _linkButtonSupport;\n\n    public MainWindow() : base(\"DetectionTool\") {\n      SetDefaultSize(400, 300);\n\n      _buttonScan = new Button(\"Scan\");\n      var labelSummary = new Label(\"Summary:\");\n      _labelSummaryValue = new Label();\n      var labelDetected = new Label(\"Detected:\");\n      _labelDetectedResult = new Label();\n      var labelStartUp = new Label(\"Detected on Startup folder:\");\n      _labelFoundInStartupValue = new Label();\n      _labelSuspiciousFiles = new Label(\"Suspicious Files:\");\n      _textBoxSuspiciousFiles = new TextView() {\n        Editable = false,\n        WrapMode = WrapMode.Word\n      };\n      _linkButtonSupport = new LinkButton(Constants.kSupportArticle, \"Get Support\");\n\n      _buttonScan.Clicked += OnButtonScanClicked;\n      _linkButtonSupport.Clicked += OnLinkButtonSupportClicked;\n\n      var mainLayout = new Box(Orientation.Vertical, 0);\n\n      mainLayout.PackStart(_buttonScan, false, false, 0);\n\n      var labelSummaryRow = new Box(Orientation.Horizontal, 0);\n      labelSummaryRow.PackStart(labelSummary, false, false, 5);\n      labelSummaryRow.PackStart(_labelSummaryValue, false, false, 0);\n      mainLayout.PackStart(labelSummaryRow, false, false, 0);\n\n      var labelDetectedRow = new Box(Orientation.Horizontal, 0);\n      labelDetectedRow.PackStart(labelDetected, false, false, 5);\n      labelDetectedRow.PackStart(_labelDetectedResult, false, false, 0);\n      mainLayout.PackStart(labelDetectedRow, false, false, 0);\n\n      var labelStartUpRow = new Box(Orientation.Horizontal, 0);\n      labelStartUpRow.PackStart(labelStartUp, false, false, 5);\n      labelStartUpRow.PackStart(_labelFoundInStartupValue, false, false, 0);\n      mainLayout.PackStart(labelStartUpRow, false, false, 0);\n      var suspiciousFilesRow = new Box(Orientation.Horizontal, 0);\n      suspiciousFilesRow.PackStart(_labelSuspiciousFiles, false, false, 0);\n      mainLayout.PackStart(new Separator(Orientation.Horizontal), false, false, 0);\n      mainLayout.PackStart(_textBoxSuspiciousFiles, true, true, 0);\n      mainLayout.PackStart(_linkButtonSupport, false, false, 0);\n\n\n      Add(mainLayout);\n\n      LoadStyles(); // Call the LoadStyles method to load the CSS styles\n\n      ShowAll();\n    }\n", "    private void OnButtonScanClicked(object? sender, EventArgs e) {\n      var scanner = new Scanner();\n\n      try {\n        var results = scanner.Scan();\n        if (results.Detected) {\n          _labelDetectedResult.Text = \"YES\";\n          _labelDetectedResult.StyleContext.AddClass(\"detected-label\");\n          _labelSummaryValue.Text = \"Possible Malware traces were detected on your machine\";\n          _labelFoundInStartupValue.Text = results.FoundInStartUp ? \"YES\" : \"NO\";\n          _labelFoundInStartupValue.StyleContext.AddClass(results.FoundInStartUp ? \"detected-label\" : \"not-detected-label\");\n          _textBoxSuspiciousFiles.Buffer.Text = string.Join(Environment.NewLine, results.DetectedFiles);\n          _labelSuspiciousFiles.Visible = true;\n          _linkButtonSupport.Visible = true;\n        } else {\n          _labelDetectedResult.Text = \"NO\";\n          _labelDetectedResult.StyleContext.AddClass(\"not-detected-label\");\n          _labelSummaryValue.Text = \"Malware was not detected on your machine\";\n          _labelFoundInStartupValue.Text = \"NO\";\n          _labelFoundInStartupValue.StyleContext.AddClass(\"not-detected-label\");\n        }", "      } catch (Exception ex) {\n        _labelDetectedResult.Text = \"Inconclusive\";\n        _labelDetectedResult.StyleContext.AddClass(\"inconclusive-label\");\n        _labelSummaryValue.Text = $\"Scan failed. {ex.Message}\";\n        _labelFoundInStartupValue.Text = \"Inconclusive\";\n        _labelFoundInStartupValue.StyleContext.AddClass(\"inconclusive-label\");\n      }\n    }\n    private void OnLinkButtonSupportClicked(object? sender, EventArgs e) {\n      var url = Constants.kSupportArticle;\n      var psi = new ProcessStartInfo {\n        FileName = url,\n        UseShellExecute = true\n      };\n      Process.Start(psi);\n    }\n\n\n", "    private void OnLinkButtonSupportClicked(object? sender, EventArgs e) {\n      var url = Constants.kSupportArticle;\n      var psi = new ProcessStartInfo {\n        FileName = url,\n        UseShellExecute = true\n      };\n      Process.Start(psi);\n    }\n\n\n", "    private void LoadStyles() {\n      var cssProvider = new CssProvider();\n      cssProvider.LoadFromPath(\"style.css\");\n\n      var styleContext = _buttonScan.StyleContext;\n      styleContext.AddProvider(cssProvider, StyleProviderPriority.Application);\n      styleContext = _labelDetectedResult.StyleContext;\n      styleContext.AddProvider(cssProvider, StyleProviderPriority.Application);\n      styleContext = _labelSummaryValue.StyleContext;\n      styleContext.AddProvider(cssProvider, StyleProviderPriority.Application);\n      styleContext = _labelFoundInStartupValue.StyleContext;\n      styleContext.AddProvider(cssProvider, StyleProviderPriority.Application);\n      styleContext = _labelSuspiciousFiles.StyleContext;\n      styleContext.AddProvider(cssProvider, StyleProviderPriority.Application);\n      styleContext = _textBoxSuspiciousFiles.StyleContext;\n      styleContext.AddProvider(cssProvider, StyleProviderPriority.Application);\n      styleContext = _linkButtonSupport.StyleContext;\n      styleContext.AddProvider(cssProvider, StyleProviderPriority.Application);\n    }\n  }\n}"]}
{"filename": "src/DetectionTool.Linux/Program.cs", "chunked_list": ["\ufeffusing Gtk;\n\nnamespace DetectionToolLinux {\n  internal static class Program {\n    /// <summary>\n    /// The main entry point for the application.\n    /// </summary>\n    [STAThread]\n    static void Main() {\n      Application.Init();\n      MainWindow mainWindow = new MainWindow();\n      mainWindow.DeleteEvent += (sender, eventArgs) => {\n        // Perform any necessary cleanup tasks here\n        Application.Quit();\n      };\n      mainWindow.ShowAll();\n      Application.Run();\n    }\n  }\n}"]}
{"filename": "src/DetectionTool/MainWindow.Designer.cs", "chunked_list": ["\ufeffusing System.Windows.Forms;\n\nnamespace DetectionTool {\n  partial class MainWindow {\n    /// <summary>\n    ///  Required designer variable.\n    /// </summary>\n    private System.ComponentModel.IContainer components = null;\n\n    /// <summary>\n    ///  Clean up any resources being used.\n    /// </summary>\n    /// <param name=\"disposing\">true if managed resources should be disposed; otherwise, false.</param>", "    protected override void Dispose(bool disposing) {\n      if (disposing && (components != null)) {\n        components.Dispose();\n      }\n      base.Dispose(disposing);\n    }\n\n    #region Windows Form Designer generated code\n\n    /// <summary>\n    ///  Required method for Designer support - do not modify\n    ///  the contents of this method with the code editor.\n    /// </summary>", "    private void InitializeComponent() {\n      this.buttonScan = new System.Windows.Forms.Button();\n      this.groupBoxScanResults = new System.Windows.Forms.GroupBox();\n      this.tableLayoutPanelResults = new System.Windows.Forms.TableLayoutPanel();\n      this.panel3 = new System.Windows.Forms.Panel();\n      this.labelFoundInStartupValue = new System.Windows.Forms.Label();\n      this.label6 = new System.Windows.Forms.Label();\n      this.label3 = new System.Windows.Forms.Label();\n      this.label4 = new System.Windows.Forms.Label();\n      this.textBoxSuspiciousFiles = new System.Windows.Forms.TextBox();\n      this.labelSuspiciousFiles = new System.Windows.Forms.Label();\n      this.panelDetected = new System.Windows.Forms.Panel();\n      this.labelDetectedResult = new System.Windows.Forms.Label();\n      this.labelDetected = new System.Windows.Forms.Label();\n      this.panel1 = new System.Windows.Forms.Panel();\n      this.labelSummaryValue = new System.Windows.Forms.Label();\n      this.label2 = new System.Windows.Forms.Label();\n      this.linkLabelSupport = new System.Windows.Forms.LinkLabel();\n      this.groupBoxScanResults.SuspendLayout();\n      this.tableLayoutPanelResults.SuspendLayout();\n      this.panel3.SuspendLayout();\n      this.panelDetected.SuspendLayout();\n      this.panel1.SuspendLayout();\n      this.SuspendLayout();\n      // \n      // buttonScan\n      // \n      this.buttonScan.Anchor = System.Windows.Forms.AnchorStyles.Top;\n      this.buttonScan.Location = new System.Drawing.Point(298, 19);\n      this.buttonScan.Name = \"buttonScan\";\n      this.buttonScan.Size = new System.Drawing.Size(99, 20);\n      this.buttonScan.TabIndex = 0;\n      this.buttonScan.Text = \"Scan\";\n      this.buttonScan.UseVisualStyleBackColor = true;\n      this.buttonScan.Click += new System.EventHandler(this.buttonScan_Click);\n      // \n      // groupBoxScanResults\n      // \n      this.groupBoxScanResults.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) \n            | System.Windows.Forms.AnchorStyles.Left) \n            | System.Windows.Forms.AnchorStyles.Right)));\n      this.groupBoxScanResults.Controls.Add(this.tableLayoutPanelResults);\n      this.groupBoxScanResults.Location = new System.Drawing.Point(10, 54);\n      this.groupBoxScanResults.Name = \"groupBoxScanResults\";\n      this.groupBoxScanResults.Size = new System.Drawing.Size(672, 347);\n      this.groupBoxScanResults.TabIndex = 1;\n      this.groupBoxScanResults.TabStop = false;\n      this.groupBoxScanResults.Text = \"Scan Results\";\n      // \n      // tableLayoutPanelResults\n      // \n      this.tableLayoutPanelResults.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) \n            | System.Windows.Forms.AnchorStyles.Left) \n            | System.Windows.Forms.AnchorStyles.Right)));\n      this.tableLayoutPanelResults.ColumnCount = 1;\n      this.tableLayoutPanelResults.ColumnStyles.Add(new System.Windows.Forms.ColumnStyle(System.Windows.Forms.SizeType.Percent, 100F));\n      this.tableLayoutPanelResults.Controls.Add(this.panel3, 0, 2);\n      this.tableLayoutPanelResults.Controls.Add(this.textBoxSuspiciousFiles, 0, 4);\n      this.tableLayoutPanelResults.Controls.Add(this.labelSuspiciousFiles, 0, 3);\n      this.tableLayoutPanelResults.Controls.Add(this.panelDetected, 0, 1);\n      this.tableLayoutPanelResults.Controls.Add(this.panel1, 0, 0);\n      this.tableLayoutPanelResults.Controls.Add(this.linkLabelSupport, 0, 6);\n      this.tableLayoutPanelResults.Location = new System.Drawing.Point(5, 19);\n      this.tableLayoutPanelResults.Name = \"tableLayoutPanelResults\";\n      this.tableLayoutPanelResults.RowCount = 7;\n      this.tableLayoutPanelResults.RowStyles.Add(new System.Windows.Forms.RowStyle());\n      this.tableLayoutPanelResults.RowStyles.Add(new System.Windows.Forms.RowStyle());\n      this.tableLayoutPanelResults.RowStyles.Add(new System.Windows.Forms.RowStyle());\n      this.tableLayoutPanelResults.RowStyles.Add(new System.Windows.Forms.RowStyle());\n      this.tableLayoutPanelResults.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Percent, 100F));\n      this.tableLayoutPanelResults.RowStyles.Add(new System.Windows.Forms.RowStyle());\n      this.tableLayoutPanelResults.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Absolute, 20F));\n      this.tableLayoutPanelResults.RowStyles.Add(new System.Windows.Forms.RowStyle(System.Windows.Forms.SizeType.Absolute, 20F));\n      this.tableLayoutPanelResults.Size = new System.Drawing.Size(662, 323);\n      this.tableLayoutPanelResults.TabIndex = 4;\n      // \n      // panel3\n      // \n      this.panel3.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) \n            | System.Windows.Forms.AnchorStyles.Left) \n            | System.Windows.Forms.AnchorStyles.Right)));\n      this.panel3.Controls.Add(this.labelFoundInStartupValue);\n      this.panel3.Controls.Add(this.label6);\n      this.panel3.Controls.Add(this.label3);\n      this.panel3.Controls.Add(this.label4);\n      this.panel3.Location = new System.Drawing.Point(3, 70);\n      this.panel3.Name = \"panel3\";\n      this.panel3.Size = new System.Drawing.Size(656, 23);\n      this.panel3.TabIndex = 10;\n      // \n      // labelFoundInStartupValue\n      // \n      this.labelFoundInStartupValue.Anchor = System.Windows.Forms.AnchorStyles.Left;\n      this.labelFoundInStartupValue.AutoSize = true;\n      this.labelFoundInStartupValue.Font = new System.Drawing.Font(\"Segoe UI\", 11.25F);\n      this.labelFoundInStartupValue.Location = new System.Drawing.Point(194, 5);\n      this.labelFoundInStartupValue.Name = \"labelFoundInStartupValue\";\n      this.labelFoundInStartupValue.Size = new System.Drawing.Size(63, 20);\n      this.labelFoundInStartupValue.TabIndex = 3;\n      this.labelFoundInStartupValue.Text = \"Not Run\";\n      // \n      // label6\n      // \n      this.label6.Anchor = System.Windows.Forms.AnchorStyles.Left;\n      this.label6.AutoSize = true;\n      this.label6.Font = new System.Drawing.Font(\"Segoe UI\", 11.25F);\n      this.label6.Location = new System.Drawing.Point(3, 5);\n      this.label6.Name = \"label6\";\n      this.label6.Size = new System.Drawing.Size(185, 20);\n      this.label6.TabIndex = 2;\n      this.label6.Text = \"Detected in Startup folder:\";\n      // \n      // label3\n      // \n      this.label3.Anchor = System.Windows.Forms.AnchorStyles.Left;\n      this.label3.AutoSize = true;\n      this.label3.Font = new System.Drawing.Font(\"Segoe UI\", 11.25F);\n      this.label3.Location = new System.Drawing.Point(113, -35);\n      this.label3.Name = \"label3\";\n      this.label3.Size = new System.Drawing.Size(63, 20);\n      this.label3.TabIndex = 1;\n      this.label3.Text = \"Not Run\";\n      // \n      // label4\n      // \n      this.label4.Anchor = System.Windows.Forms.AnchorStyles.Left;\n      this.label4.AutoSize = true;\n      this.label4.Font = new System.Drawing.Font(\"Segoe UI\", 11.25F);\n      this.label4.Location = new System.Drawing.Point(3, -35);\n      this.label4.Name = \"label4\";\n      this.label4.Size = new System.Drawing.Size(122, 20);\n      this.label4.TabIndex = 0;\n      this.label4.Text = \"Found in registry:\";\n      // \n      // textBoxSuspiciousFiles\n      // \n      this.textBoxSuspiciousFiles.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) \n            | System.Windows.Forms.AnchorStyles.Left) \n            | System.Windows.Forms.AnchorStyles.Right)));\n      this.textBoxSuspiciousFiles.Location = new System.Drawing.Point(3, 123);\n      this.textBoxSuspiciousFiles.Multiline = true;\n      this.textBoxSuspiciousFiles.Name = \"textBoxSuspiciousFiles\";\n      this.textBoxSuspiciousFiles.Size = new System.Drawing.Size(656, 177);\n      this.textBoxSuspiciousFiles.TabIndex = 7;\n      this.textBoxSuspiciousFiles.Visible = false;\n      // \n      // labelSuspiciousFiles\n      // \n      this.labelSuspiciousFiles.Anchor = System.Windows.Forms.AnchorStyles.Left;\n      this.labelSuspiciousFiles.AutoSize = true;\n      this.labelSuspiciousFiles.Font = new System.Drawing.Font(\"Segoe UI\", 11.25F, ((System.Drawing.FontStyle)((System.Drawing.FontStyle.Bold | System.Drawing.FontStyle.Underline))));\n      this.labelSuspiciousFiles.Location = new System.Drawing.Point(5, 100);\n      this.labelSuspiciousFiles.Margin = new System.Windows.Forms.Padding(5, 4, 3, 0);\n      this.labelSuspiciousFiles.Name = \"labelSuspiciousFiles\";\n      this.labelSuspiciousFiles.Size = new System.Drawing.Size(117, 20);\n      this.labelSuspiciousFiles.TabIndex = 8;\n      this.labelSuspiciousFiles.Text = \"Suspicious Files\";\n      this.labelSuspiciousFiles.Visible = false;\n      // \n      // panelDetected\n      // \n      this.panelDetected.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) \n            | System.Windows.Forms.AnchorStyles.Left) \n            | System.Windows.Forms.AnchorStyles.Right)));\n      this.panelDetected.Controls.Add(this.labelDetectedResult);\n      this.panelDetected.Controls.Add(this.labelDetected);\n      this.panelDetected.Location = new System.Drawing.Point(3, 36);\n      this.panelDetected.Name = \"panelDetected\";\n      this.panelDetected.Size = new System.Drawing.Size(656, 28);\n      this.panelDetected.TabIndex = 5;\n      // \n      // labelDetectedResult\n      // \n      this.labelDetectedResult.Anchor = System.Windows.Forms.AnchorStyles.Left;\n      this.labelDetectedResult.AutoSize = true;\n      this.labelDetectedResult.Font = new System.Drawing.Font(\"Segoe UI\", 11.25F);\n      this.labelDetectedResult.Location = new System.Drawing.Point(71, 5);\n      this.labelDetectedResult.Name = \"labelDetectedResult\";\n      this.labelDetectedResult.Size = new System.Drawing.Size(63, 20);\n      this.labelDetectedResult.TabIndex = 1;\n      this.labelDetectedResult.Text = \"Not Run\";\n      // \n      // labelDetected\n      // \n      this.labelDetected.Anchor = System.Windows.Forms.AnchorStyles.Left;\n      this.labelDetected.AutoSize = true;\n      this.labelDetected.Font = new System.Drawing.Font(\"Segoe UI\", 11.25F);\n      this.labelDetected.Location = new System.Drawing.Point(3, 5);\n      this.labelDetected.Name = \"labelDetected\";\n      this.labelDetected.Size = new System.Drawing.Size(73, 20);\n      this.labelDetected.TabIndex = 0;\n      this.labelDetected.Text = \"Detected:\";\n      // \n      // panel1\n      // \n      this.panel1.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) \n            | System.Windows.Forms.AnchorStyles.Left) \n            | System.Windows.Forms.AnchorStyles.Right)));\n      this.panel1.Controls.Add(this.labelSummaryValue);\n      this.panel1.Controls.Add(this.label2);\n      this.panel1.Location = new System.Drawing.Point(3, 3);\n      this.panel1.Name = \"panel1\";\n      this.panel1.Size = new System.Drawing.Size(656, 27);\n      this.panel1.TabIndex = 6;\n      // \n      // labelSummaryValue\n      // \n      this.labelSummaryValue.Anchor = System.Windows.Forms.AnchorStyles.Left;\n      this.labelSummaryValue.AutoSize = true;\n      this.labelSummaryValue.Font = new System.Drawing.Font(\"Segoe UI\", 11.25F);\n      this.labelSummaryValue.Location = new System.Drawing.Point(72, 5);\n      this.labelSummaryValue.Name = \"labelSummaryValue\";\n      this.labelSummaryValue.Size = new System.Drawing.Size(63, 20);\n      this.labelSummaryValue.TabIndex = 1;\n      this.labelSummaryValue.Text = \"Not Run\";\n      // \n      // label2\n      // \n      this.label2.Anchor = System.Windows.Forms.AnchorStyles.Left;\n      this.label2.AutoSize = true;\n      this.label2.Font = new System.Drawing.Font(\"Segoe UI\", 11.25F);\n      this.label2.Location = new System.Drawing.Point(3, 5);\n      this.label2.Name = \"label2\";\n      this.label2.Size = new System.Drawing.Size(74, 20);\n      this.label2.TabIndex = 0;\n      this.label2.Text = \"Summary:\";\n      // \n      // linkLabelSupport\n      // \n      this.linkLabelSupport.Anchor = System.Windows.Forms.AnchorStyles.None;\n      this.linkLabelSupport.AutoSize = true;\n      this.linkLabelSupport.Font = new System.Drawing.Font(\"Microsoft Sans Serif\", 12F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(177)));\n      this.linkLabelSupport.Location = new System.Drawing.Point(170, 303);\n      this.linkLabelSupport.Name = \"linkLabelSupport\";\n      this.linkLabelSupport.Size = new System.Drawing.Size(322, 20);\n      this.linkLabelSupport.TabIndex = 12;\n      this.linkLabelSupport.TabStop = true;\n      this.linkLabelSupport.Text = \"For instructions on what to do next click here\";\n      this.linkLabelSupport.Visible = false;\n      this.linkLabelSupport.LinkClicked += new System.Windows.Forms.LinkLabelLinkClickedEventHandler(this.linkLabelSupport_LinkClicked);\n      // \n      // MainWindow\n      // \n      this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);\n      this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;\n      this.ClientSize = new System.Drawing.Size(693, 412);\n      this.Controls.Add(this.groupBoxScanResults);\n      this.Controls.Add(this.buttonScan);\n      this.Name = \"MainWindow\";\n      this.Text = \"Detection Tool\";\n      this.groupBoxScanResults.ResumeLayout(false);\n      this.tableLayoutPanelResults.ResumeLayout(false);\n      this.tableLayoutPanelResults.PerformLayout();\n      this.panel3.ResumeLayout(false);\n      this.panel3.PerformLayout();\n      this.panelDetected.ResumeLayout(false);\n      this.panelDetected.PerformLayout();\n      this.panel1.ResumeLayout(false);\n      this.panel1.PerformLayout();\n      this.ResumeLayout(false);\n\n    }\n\n    #endregion\n", "    private Button buttonScan;\n    private GroupBox groupBoxScanResults;\n    private Label labelDetectedResult;\n    private Label labelDetected;\n    private TableLayoutPanel tableLayoutPanelResults;\n    private Panel panelDetected;\n    private Panel panel1;\n    private Label labelSummaryValue;\n    private Label label2;\n    private TextBox textBoxSuspiciousFiles;\n    private Label labelSuspiciousFiles;", "    private Label label2;\n    private TextBox textBoxSuspiciousFiles;\n    private Label labelSuspiciousFiles;\n    private Panel panel3;\n    private Label labelFoundInStartupValue;\n    private Label label6;\n    private Label label3;\n    private Label label4;\n    private LinkLabel linkLabelSupport;\n  }\n}", "    private LinkLabel linkLabelSupport;\n  }\n}"]}
{"filename": "src/DetectionTool/MainWindow.cs", "chunked_list": ["\ufeffusing DetectionTool.Core;\nusing System;\nusing System.Drawing;\nusing System.Windows.Forms;\n\nnamespace DetectionTool {\n  public partial class MainWindow : Form {\n    public MainWindow() {\n      InitializeComponent();\n    }\n", "    private void buttonScan_Click(object sender, EventArgs e) {\n      var scanner = new Scanner();\n\n      try {\n        var results = scanner.Scan();\n\n        groupBoxScanResults.Visible = true;\n        if (results.Detected) {\n          labelDetectedResult.Text = \"YES\";\n          labelDetectedResult.ForeColor = Color.Red;\n          labelSummaryValue.Text = \"Possible Malware traces were detected on your machine\";\n          labelFoundInStartupValue.Text = results.FoundInStartUp ? \"YES\" : \"NO\";\n          labelFoundInStartupValue.ForeColor = results.FoundInStartUp ? Color.Red : Color.Green;\n          textBoxSuspiciousFiles.Text = string.Join(Environment.NewLine, results.DetectedFiles);\n          labelSuspiciousFiles.Visible = true;\n          textBoxSuspiciousFiles.Visible = true;\n          linkLabelSupport.Visible = true;\n\n        } else {\n          labelDetectedResult.Text = \"NO\";\n          labelDetectedResult.ForeColor = Color.Green;\n          labelSummaryValue.Text = \"Malware was not detected on your machine\";\n          labelFoundInStartupValue.Text = \"NO\";\n          labelFoundInStartupValue.ForeColor = Color.Green;\n        }", "      } catch (Exception ex) {\n        labelDetectedResult.Text = \"Inconclusive\";\n        labelDetectedResult.ForeColor = Color.Orange;\n        labelSummaryValue.Text = $\"Scan failed. {ex.Message}\";\n        labelFoundInStartupValue.Text = \"Inconclusive\";\n        labelFoundInStartupValue.ForeColor = Color.Orange;\n      }\n    }\n\n    private void linkLabelSupport_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e) {\n      System.Diagnostics.Process.Start(Constants.kSupportArticle);\n    }\n  }\n}\n", "    private void linkLabelSupport_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e) {\n      System.Diagnostics.Process.Start(Constants.kSupportArticle);\n    }\n  }\n}\n"]}
{"filename": "src/DetectionTool/Program.cs", "chunked_list": ["\ufeffusing System;\nusing System.Windows.Forms;\n\nnamespace DetectionTool {\n  internal static class Program {\n    /// <summary>\n    /// The main entry point for the application.\n    /// </summary>\n    [STAThread]\n    static void Main() {\n      Application.EnableVisualStyles();\n      Application.SetCompatibleTextRenderingDefault(false);\n      Application.Run(new MainWindow());\n    }\n  }\n}\n"]}
{"filename": "src/DetectionTool/Properties/Settings.Designer.cs", "chunked_list": ["\ufeff//------------------------------------------------------------------------------\n// <auto-generated>\n//     This code was generated by a tool.\n//     Runtime Version:4.0.30319.42000\n//\n//     Changes to this file may cause incorrect behavior and will be lost if\n//     the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------\n", "//------------------------------------------------------------------------------\n\nnamespace DetectionTool.Properties {\n    \n    \n    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]\n    [global::System.CodeDom.Compiler.GeneratedCodeAttribute(\"Microsoft.VisualStudio.Editors.SettingsDesigner.SettingsSingleFileGenerator\", \"17.6.0.0\")]\n    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {\n        \n        private static Settings defaultInstance = ((Settings)(global::System.Configuration.ApplicationSettingsBase.Synchronized(new Settings())));\n        ", "        private static Settings defaultInstance = ((Settings)(global::System.Configuration.ApplicationSettingsBase.Synchronized(new Settings())));\n        \n        public static Settings Default {\n            get {\n                return defaultInstance;\n            }\n        }\n    }\n}\n"]}
{"filename": "src/DetectionTool/Properties/Resources.Designer.cs", "chunked_list": ["\ufeff//------------------------------------------------------------------------------\n// <auto-generated>\n//     This code was generated by a tool.\n//     Runtime Version:4.0.30319.42000\n//\n//     Changes to this file may cause incorrect behavior and will be lost if\n//     the code is regenerated.\n// </auto-generated>\n//------------------------------------------------------------------------------\n", "//------------------------------------------------------------------------------\n\nnamespace DetectionTool.Properties {\n    using System;\n    \n    \n    /// <summary>\n    ///   A strongly-typed resource class, for looking up localized strings, etc.\n    /// </summary>\n    // This class was auto-generated by the StronglyTypedResourceBuilder\n    // class via a tool like ResGen or Visual Studio.\n    // To add or remove a member, edit your .ResX file then rerun ResGen\n    // with the /str option, or rebuild your VS project.\n    [global::System.CodeDom.Compiler.GeneratedCodeAttribute(\"System.Resources.Tools.StronglyTypedResourceBuilder\", \"17.0.0.0\")]\n    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]\n    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]", "    /// </summary>\n    // This class was auto-generated by the StronglyTypedResourceBuilder\n    // class via a tool like ResGen or Visual Studio.\n    // To add or remove a member, edit your .ResX file then rerun ResGen\n    // with the /str option, or rebuild your VS project.\n    [global::System.CodeDom.Compiler.GeneratedCodeAttribute(\"System.Resources.Tools.StronglyTypedResourceBuilder\", \"17.0.0.0\")]\n    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]\n    [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]\n    internal class Resources {\n        \n        private static global::System.Resources.ResourceManager resourceMan;\n        ", "    internal class Resources {\n        \n        private static global::System.Resources.ResourceManager resourceMan;\n        \n        private static global::System.Globalization.CultureInfo resourceCulture;\n        \n        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute(\"Microsoft.Performance\", \"CA1811:AvoidUncalledPrivateCode\")]\n        internal Resources() {\n        }\n        \n        /// <summary>\n        ///   Returns the cached ResourceManager instance used by this class.\n        /// </summary>\n        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]\n        internal static global::System.Resources.ResourceManager ResourceManager {\n            get {", "                if (object.ReferenceEquals(resourceMan, null)) {\n                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager(\"DetectionTool.Properties.Resources\", typeof(Resources).Assembly);\n                    resourceMan = temp;\n                }\n                return resourceMan;\n            }\n        }\n        \n        /// <summary>\n        ///   Overrides the current thread's CurrentUICulture property for all\n        ///   resource lookups using this strongly typed resource class.\n        /// </summary>\n        [global::System.ComponentModel.EditorBrowsableAttribute(global::System.ComponentModel.EditorBrowsableState.Advanced)]\n        internal static global::System.Globalization.CultureInfo Culture {\n            get {\n                return resourceCulture;\n            }\n            set {\n                resourceCulture = value;\n            }\n        }\n    }\n}\n"]}
{"filename": "src/DetectionTool/Properties/AssemblyInfo.cs", "chunked_list": ["\ufeffusing System.Reflection;\nusing System.Runtime.InteropServices;\n\n// General Information about an assembly is controlled through the following\n// set of attributes. Change these attribute values to modify the information\n// associated with an assembly.\n[assembly: AssemblyTitle(\"DetectionTool\")]\n[assembly: AssemblyDescription(\"\")]\n[assembly: AssemblyConfiguration(\"\")]\n[assembly: AssemblyCompany(\"\")]", "[assembly: AssemblyConfiguration(\"\")]\n[assembly: AssemblyCompany(\"\")]\n[assembly: AssemblyProduct(\"DetectionTool\")]\n[assembly: AssemblyCopyright(\"Copyright \u00a9  2023\")]\n[assembly: AssemblyTrademark(\"\")]\n[assembly: AssemblyCulture(\"\")]\n\n// Setting ComVisible to false makes the types in this assembly not visible\n// to COM components.  If you need to access a type in this assembly from\n// COM, set the ComVisible attribute to true on that type.", "// to COM components.  If you need to access a type in this assembly from\n// COM, set the ComVisible attribute to true on that type.\n[assembly: ComVisible(false)]\n\n// The following GUID is for the ID of the typelib if this project is exposed to COM\n[assembly: Guid(\"7070d53e-1e0d-4f5c-92a4-0244a412ac66\")]\n\n// Version information for an assembly consists of the following four values:\n//\n//      Major Version", "//\n//      Major Version\n//      Minor Version\n//      Build Number\n//      Revision\n//\n// You can specify all the values or you can default the Build and Revision Numbers\n// by using the '*' as shown below:\n// [assembly: AssemblyVersion(\"1.0.*\")]\n[assembly: AssemblyVersion(\"0.2.0.0\")]", "// [assembly: AssemblyVersion(\"1.0.*\")]\n[assembly: AssemblyVersion(\"0.2.0.0\")]\n[assembly: AssemblyFileVersion(\"0.2.0.0\")]\n"]}
